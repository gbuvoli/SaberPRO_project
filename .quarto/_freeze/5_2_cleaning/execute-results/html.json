{
  "hash": "23c86809b1a26f946ed7766807ed5153",
  "result": {
    "markdown": "---\nexecute:\n  echo: true\n  enabled: true\nformat: \n  html:\n    code-fold: true\n    code-summary: \"Show the code\"\n---\n\n\n# Data Cleaning and Wrangling\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nsam=pd.read_csv(\"sam.csv\")\nsam\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Periodo</th>\n      <th>Aplicacion</th>\n      <th>Examen</th>\n      <th>Tipo_Documento</th>\n      <th>Documento</th>\n      <th>Nombre</th>\n      <th>Numero_Registro</th>\n      <th>Tipo_Evaluado</th>\n      <th>SNIES_Programa</th>\n      <th>Programa</th>\n      <th>...</th>\n      <th>NBC</th>\n      <th>PG</th>\n      <th>Perc_Global</th>\n      <th>Perc_NBC</th>\n      <th>Modulo</th>\n      <th>PM</th>\n      <th>Nivel_Desempeño</th>\n      <th>Perc_Mod</th>\n      <th>Perc_nbc_mod</th>\n      <th>Novedades</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1140901584</td>\n      <td>SEBASTIAN  NORIEGA MARTINEZ</td>\n      <td>EK202120012963</td>\n      <td>Estudiante</td>\n      <td>1277</td>\n      <td>INGENIERIA MECANICA</td>\n      <td>...</td>\n      <td>INGENIERÍA MECÁNICA Y AFINES</td>\n      <td>176</td>\n      <td>88</td>\n      <td>74</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>153</td>\n      <td>2</td>\n      <td>59</td>\n      <td>46</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1140901584</td>\n      <td>SEBASTIAN  NORIEGA MARTINEZ</td>\n      <td>EK202120012963</td>\n      <td>Estudiante</td>\n      <td>1277</td>\n      <td>INGENIERIA MECANICA</td>\n      <td>...</td>\n      <td>INGENIERÍA MECÁNICA Y AFINES</td>\n      <td>176</td>\n      <td>88</td>\n      <td>74</td>\n      <td>COMUNICACIÓN ESCRITA</td>\n      <td>156</td>\n      <td>3</td>\n      <td>68</td>\n      <td>67</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1140901584</td>\n      <td>SEBASTIAN  NORIEGA MARTINEZ</td>\n      <td>EK202120012963</td>\n      <td>Estudiante</td>\n      <td>1277</td>\n      <td>INGENIERIA MECANICA</td>\n      <td>...</td>\n      <td>INGENIERÍA MECÁNICA Y AFINES</td>\n      <td>176</td>\n      <td>88</td>\n      <td>74</td>\n      <td>DISEÑO DE SISTEMAS MECÁNICOS</td>\n      <td>174</td>\n      <td>3</td>\n      <td>83</td>\n      <td>83</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1140901584</td>\n      <td>SEBASTIAN  NORIEGA MARTINEZ</td>\n      <td>EK202120012963</td>\n      <td>Estudiante</td>\n      <td>1277</td>\n      <td>INGENIERIA MECANICA</td>\n      <td>...</td>\n      <td>INGENIERÍA MECÁNICA Y AFINES</td>\n      <td>176</td>\n      <td>88</td>\n      <td>74</td>\n      <td>INGLÉS</td>\n      <td>213</td>\n      <td>B2</td>\n      <td>97</td>\n      <td>95</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1140901584</td>\n      <td>SEBASTIAN  NORIEGA MARTINEZ</td>\n      <td>EK202120012963</td>\n      <td>Estudiante</td>\n      <td>1277</td>\n      <td>INGENIERIA MECANICA</td>\n      <td>...</td>\n      <td>INGENIERÍA MECÁNICA Y AFINES</td>\n      <td>176</td>\n      <td>88</td>\n      <td>74</td>\n      <td>LECTURA CRÍTICA</td>\n      <td>147</td>\n      <td>2</td>\n      <td>53</td>\n      <td>40</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>48500</th>\n      <td>2022</td>\n      <td>SABER PRO Y TYT EXTERIOR - 20222</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1003403093</td>\n      <td>JUAN JAVIER JARABA PARRA</td>\n      <td>EK202260013466</td>\n      <td>Estudiante</td>\n      <td>12075</td>\n      <td>RELACIONES INTERNACIONALES</td>\n      <td>...</td>\n      <td>CIENCIA POLÍTICA, RELACIONES INTERNACIONALES</td>\n      <td>176</td>\n      <td>87</td>\n      <td>54</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>201</td>\n      <td>4</td>\n      <td>96</td>\n      <td>75</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>48501</th>\n      <td>2022</td>\n      <td>SABER PRO Y TYT EXTERIOR - 20222</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1003403093</td>\n      <td>JUAN JAVIER JARABA PARRA</td>\n      <td>EK202260013466</td>\n      <td>Estudiante</td>\n      <td>12075</td>\n      <td>RELACIONES INTERNACIONALES</td>\n      <td>...</td>\n      <td>CIENCIA POLÍTICA, RELACIONES INTERNACIONALES</td>\n      <td>176</td>\n      <td>87</td>\n      <td>54</td>\n      <td>COMUNICACIÓN ESCRITA</td>\n      <td>150</td>\n      <td>3</td>\n      <td>57</td>\n      <td>28</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>48502</th>\n      <td>2022</td>\n      <td>SABER PRO Y TYT EXTERIOR - 20222</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1003403093</td>\n      <td>JUAN JAVIER JARABA PARRA</td>\n      <td>EK202260013466</td>\n      <td>Estudiante</td>\n      <td>12075</td>\n      <td>RELACIONES INTERNACIONALES</td>\n      <td>...</td>\n      <td>CIENCIA POLÍTICA, RELACIONES INTERNACIONALES</td>\n      <td>176</td>\n      <td>87</td>\n      <td>54</td>\n      <td>INGLÉS</td>\n      <td>218</td>\n      <td>B2</td>\n      <td>98</td>\n      <td>92</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>48503</th>\n      <td>2022</td>\n      <td>SABER PRO Y TYT EXTERIOR - 20222</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1003403093</td>\n      <td>JUAN JAVIER JARABA PARRA</td>\n      <td>EK202260013466</td>\n      <td>Estudiante</td>\n      <td>12075</td>\n      <td>RELACIONES INTERNACIONALES</td>\n      <td>...</td>\n      <td>CIENCIA POLÍTICA, RELACIONES INTERNACIONALES</td>\n      <td>176</td>\n      <td>87</td>\n      <td>54</td>\n      <td>LECTURA CRÍTICA</td>\n      <td>162</td>\n      <td>3</td>\n      <td>62</td>\n      <td>24</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>48504</th>\n      <td>2022</td>\n      <td>SABER PRO Y TYT EXTERIOR - 20222</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1003403093</td>\n      <td>JUAN JAVIER JARABA PARRA</td>\n      <td>EK202260013466</td>\n      <td>Estudiante</td>\n      <td>12075</td>\n      <td>RELACIONES INTERNACIONALES</td>\n      <td>...</td>\n      <td>CIENCIA POLÍTICA, RELACIONES INTERNACIONALES</td>\n      <td>176</td>\n      <td>87</td>\n      <td>54</td>\n      <td>RAZONAMIENTO CUANTITATIVO</td>\n      <td>148</td>\n      <td>2</td>\n      <td>53</td>\n      <td>37</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>48505 rows × 22 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\n# Ajusto tipo de variables.\nsam[['Periodo','SNIES_Programa','ID_NBC']]=sam[['Periodo','SNIES_Programa','ID_NBC']].astype(str)\n\n#Separo variables categoricas\nsam_cat=[]\nsam_num=[]\nfor col in list(sam.columns):\n    if sam[col].dtype=='O':\n        sam_cat.append(col)\n    else:\n        sam_num.append(col)\nprint(sam_cat)\nprint(sam_num)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n['Periodo', 'Aplicacion', 'Examen', 'Tipo_Documento', 'Documento', 'Nombre', 'Numero_Registro', 'Tipo_Evaluado', 'SNIES_Programa', 'Programa', 'Ciudad', 'ID_NBC', 'NBC', 'Modulo', 'Nivel_Desempeño', 'Novedades']\n['PG', 'Perc_Global', 'Perc_NBC', 'PM', 'Perc_Mod', 'Perc_nbc_mod']\n```\n:::\n:::\n\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\n#Eliminamos los registros que tienen alguna observación o irregularidad con la presentación de la prueba\nsam= sam[sam['Novedades'].isnull()]\nsam['Novedades'].notnull().sum()\nsam.drop('Novedades', axis=1, inplace=True)\n\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nC:\\Users\\fredy\\AppData\\Local\\Temp\\ipykernel_8888\\4024167424.py:4: SettingWithCopyWarning:\n\n\nA value is trying to be set on a copy of a slice from a DataFrame\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n\n```\n:::\n:::\n\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\n#Revisamos el tipo de examen para eliminar los que sean diferentes a Saber Pro\nsam['Examen'].value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\nExamen\nSaber Pro    47558\nName: count, dtype: int64\n```\n:::\n:::\n\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\n#Ahora revisamos Tipo_Evaluado \nsam['Tipo_Evaluado'].value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```\nTipo_Evaluado\nEstudiante    47418\nIndividual      140\nName: count, dtype: int64\n```\n:::\n:::\n\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\n# Ahora eliminamos los registros de Tipo_Evaluado = Individual\nsam=sam[sam['Tipo_Evaluado'] != 'Individual']\nsam.sample(10)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Periodo</th>\n      <th>Aplicacion</th>\n      <th>Examen</th>\n      <th>Tipo_Documento</th>\n      <th>Documento</th>\n      <th>Nombre</th>\n      <th>Numero_Registro</th>\n      <th>Tipo_Evaluado</th>\n      <th>SNIES_Programa</th>\n      <th>Programa</th>\n      <th>...</th>\n      <th>ID_NBC</th>\n      <th>NBC</th>\n      <th>PG</th>\n      <th>Perc_Global</th>\n      <th>Perc_NBC</th>\n      <th>Modulo</th>\n      <th>PM</th>\n      <th>Nivel_Desempeño</th>\n      <th>Perc_Mod</th>\n      <th>Perc_nbc_mod</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>21467</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1081833764</td>\n      <td>DANIELA MARIA JARABA SALAZAR</td>\n      <td>EK202120937375</td>\n      <td>Estudiante</td>\n      <td>3269</td>\n      <td>INGENIERIA ELECTRONICA</td>\n      <td>...</td>\n      <td>29</td>\n      <td>INGENIERÍA ELECTRÓNICA, TELECOMUNICACIONES Y A...</td>\n      <td>169</td>\n      <td>82</td>\n      <td>71</td>\n      <td>COMUNICACIÓN ESCRITA</td>\n      <td>152</td>\n      <td>3</td>\n      <td>61</td>\n      <td>63</td>\n    </tr>\n    <tr>\n      <th>5233</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1140902004</td>\n      <td>GABRIELLA  JARAMILLO PARADA</td>\n      <td>EK202120994079</td>\n      <td>Estudiante</td>\n      <td>90329</td>\n      <td>ARQUITECTURA</td>\n      <td>...</td>\n      <td>18</td>\n      <td>ARQUITECTURA</td>\n      <td>154</td>\n      <td>65</td>\n      <td>59</td>\n      <td>COMUNICACIÓN ESCRITA</td>\n      <td>142</td>\n      <td>2</td>\n      <td>53</td>\n      <td>58</td>\n    </tr>\n    <tr>\n      <th>30125</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1051677326</td>\n      <td>CARLOS ENRIQUE EHRHARDT VILLANUEVA</td>\n      <td>EK202122581858</td>\n      <td>Estudiante</td>\n      <td>1277</td>\n      <td>INGENIERIA MECANICA</td>\n      <td>...</td>\n      <td>31</td>\n      <td>INGENIERÍA MECÁNICA Y AFINES</td>\n      <td>130</td>\n      <td>30</td>\n      <td>15</td>\n      <td>INGLÉS</td>\n      <td>131</td>\n      <td>A2</td>\n      <td>24</td>\n      <td>11</td>\n    </tr>\n    <tr>\n      <th>20086</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1140900609</td>\n      <td>JUAN DIEGO ROLDAN SIERRA</td>\n      <td>EK202120669036</td>\n      <td>Estudiante</td>\n      <td>1277</td>\n      <td>INGENIERIA MECANICA</td>\n      <td>...</td>\n      <td>31</td>\n      <td>INGENIERÍA MECÁNICA Y AFINES</td>\n      <td>181</td>\n      <td>91</td>\n      <td>80</td>\n      <td>PENSAMIENTO CIENTÍFICO - CIENCIAS FÍSICAS</td>\n      <td>177</td>\n      <td>3</td>\n      <td>81</td>\n      <td>79</td>\n    </tr>\n    <tr>\n      <th>16463</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1083048511</td>\n      <td>LAURA ARALY ZAPATA PRADA</td>\n      <td>EK202120032235</td>\n      <td>Estudiante</td>\n      <td>1276</td>\n      <td>INGENIERIA INDUSTRIAL</td>\n      <td>...</td>\n      <td>30</td>\n      <td>INGENIERÍA INDUSTRIAL Y AFINES</td>\n      <td>185</td>\n      <td>94</td>\n      <td>94</td>\n      <td>DISEÑO DE SISTEMAS PRODUCTIVOS Y LOGÍSTICOS</td>\n      <td>210</td>\n      <td>4</td>\n      <td>98</td>\n      <td>98</td>\n    </tr>\n    <tr>\n      <th>32994</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-1</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1010127001</td>\n      <td>SAMIR ALEJANDRO PEREZ BAZZA</td>\n      <td>EK202220294025</td>\n      <td>Estudiante</td>\n      <td>1274</td>\n      <td>INGENIERIA DE SISTEMAS Y COMPUTACION</td>\n      <td>...</td>\n      <td>27</td>\n      <td>INGENIERÍA DE SISTEMAS, TELEMÁTICA Y AFINES</td>\n      <td>178</td>\n      <td>91</td>\n      <td>89</td>\n      <td>RAZONAMIENTO CUANTITATIVO</td>\n      <td>186</td>\n      <td>3</td>\n      <td>91</td>\n      <td>84</td>\n    </tr>\n    <tr>\n      <th>20177</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1001999933</td>\n      <td>JUAN DAVID CONRADO PERTUZ</td>\n      <td>EK202120677161</td>\n      <td>Estudiante</td>\n      <td>1274</td>\n      <td>INGENIERIA DE SISTEMAS Y COMPUTACION</td>\n      <td>...</td>\n      <td>27</td>\n      <td>INGENIERÍA DE SISTEMAS, TELEMÁTICA Y AFINES</td>\n      <td>219</td>\n      <td>100</td>\n      <td>100</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>194</td>\n      <td>3</td>\n      <td>94</td>\n      <td>94</td>\n    </tr>\n    <tr>\n      <th>45219</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1143171140</td>\n      <td>DANIEL ENRIQUE MEZA VARELA</td>\n      <td>EK202251131853</td>\n      <td>Estudiante</td>\n      <td>1274</td>\n      <td>INGENIERIA DE SISTEMAS Y COMPUTACION</td>\n      <td>...</td>\n      <td>27</td>\n      <td>INGENIERÍA DE SISTEMAS, TELEMÁTICA Y AFINES</td>\n      <td>154</td>\n      <td>63</td>\n      <td>58</td>\n      <td>RAZONAMIENTO CUANTITATIVO</td>\n      <td>145</td>\n      <td>2</td>\n      <td>50</td>\n      <td>36</td>\n    </tr>\n    <tr>\n      <th>634</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1067968330</td>\n      <td>LAURA LILIANA OROZCO TAPIA</td>\n      <td>EK202120154641</td>\n      <td>Estudiante</td>\n      <td>104980</td>\n      <td>GEOLOG¿A</td>\n      <td>...</td>\n      <td>36</td>\n      <td>GEOLOGÍA, OTROS PROGRAMAS DE CIENCIAS NATURALES</td>\n      <td>193</td>\n      <td>97</td>\n      <td>81</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>197</td>\n      <td>3</td>\n      <td>95</td>\n      <td>81</td>\n    </tr>\n    <tr>\n      <th>17290</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1045756084</td>\n      <td>MARTHA ISABELLA GUERRERO ESPINOSA</td>\n      <td>EK202120196907</td>\n      <td>Estudiante</td>\n      <td>1272</td>\n      <td>ADMINISTRACION DE EMPRESAS</td>\n      <td>...</td>\n      <td>9</td>\n      <td>ADMINISTRACIÓN</td>\n      <td>162</td>\n      <td>75</td>\n      <td>85</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>164</td>\n      <td>3</td>\n      <td>71</td>\n      <td>82</td>\n    </tr>\n  </tbody>\n</table>\n<p>10 rows × 21 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\n# Del campo programa, buscamos aquellos que no pertenecen a Uninorte y los eliminamos.\nsam['Programa'].value_counts()\nprint('todos pertenecen a la universidad')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntodos pertenecen a la universidad\n```\n:::\n:::\n\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\n#Seleccionemos ahora los módulos de los componentes genéricos\nsam['Modulo'].value_counts()\ncompetencias=[\n    \"COMPETENCIAS CIUDADANAS\",\n    \"COMUNICACIÓN ESCRITA\",\n    \"INGLÉS\",\n    \"LECTURA CRÍTICA\",\n    \"RAZONAMIENTO CUANTITATIVO\"\n]\n\nsam=sam[sam['Modulo'].isin(competencias)]\n```\n:::\n\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\n# Nivel de desempeño tiene Nulos.\nsam['Nivel_Desempeño'].value_counts()\n#sam[sam['Nivel_Desempeño'].isnull()]\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```\nNivel_Desempeño\n3     16021\n2      5646\n4      4368\nB2     3789\n1      2692\nB1     2612\nA2      743\nA1       79\nName: count, dtype: int64\n```\n:::\n:::\n\n\n:::{.callout-important}\nLos valores Nulos del campo Nivel de Desempeño corresponden a aquellos en donde el puntaje del modulo es cero (0)\n:::\n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\n#Elimino registros duplicados, es decir que todas las columnas tengan los mismos valores.\nsamND = sam.drop_duplicates()\n#Ahora reviso cuantas apariciones tiene un estudiante en el dataset, deben tener 5 registros por documento.\nconteo_doc=samND['Documento'].value_counts()\nconteo_doc\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```\nDocumento\n1234095944    10\n1083039156    10\n1045744810    10\n1001825465     5\n1002153246     5\n              ..\n1143171004     5\n1140902757     5\n1234097227     5\n1192796697     5\n1003403093     5\nName: count, Length: 4690, dtype: int64\n```\n:::\n:::\n\n\n::: {.cell execution_count=12}\n``` {.python .cell-code}\n#Revisemos aquellos casos en los que hay mas de 5 registros por documento\nrepeated_doc= conteo_doc[conteo_doc>5].index.tolist()\n\nsamND[samND['Documento'].isin(repeated_doc) ].sort_values(['Periodo','Documento'])\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Periodo</th>\n      <th>Aplicacion</th>\n      <th>Examen</th>\n      <th>Tipo_Documento</th>\n      <th>Documento</th>\n      <th>Nombre</th>\n      <th>Numero_Registro</th>\n      <th>Tipo_Evaluado</th>\n      <th>SNIES_Programa</th>\n      <th>Programa</th>\n      <th>...</th>\n      <th>ID_NBC</th>\n      <th>NBC</th>\n      <th>PG</th>\n      <th>Perc_Global</th>\n      <th>Perc_NBC</th>\n      <th>Modulo</th>\n      <th>PM</th>\n      <th>Nivel_Desempeño</th>\n      <th>Perc_Mod</th>\n      <th>Perc_nbc_mod</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>14685</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1045744810</td>\n      <td>LAURA CECILIA NAME CAMARGO</td>\n      <td>EK202122849586</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>42</td>\n      <td>1</td>\n      <td>1</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>14686</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1045744810</td>\n      <td>LAURA CECILIA NAME CAMARGO</td>\n      <td>EK202122849586</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>42</td>\n      <td>1</td>\n      <td>1</td>\n      <td>COMUNICACIÓN ESCRITA</td>\n      <td>131</td>\n      <td>2</td>\n      <td>43</td>\n      <td>36</td>\n    </tr>\n    <tr>\n      <th>14688</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1045744810</td>\n      <td>LAURA CECILIA NAME CAMARGO</td>\n      <td>EK202122849586</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>42</td>\n      <td>1</td>\n      <td>1</td>\n      <td>INGLÉS</td>\n      <td>0</td>\n      <td>A1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>14690</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1045744810</td>\n      <td>LAURA CECILIA NAME CAMARGO</td>\n      <td>EK202122849586</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>42</td>\n      <td>1</td>\n      <td>1</td>\n      <td>LECTURA CRÍTICA</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>14691</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1045744810</td>\n      <td>LAURA CECILIA NAME CAMARGO</td>\n      <td>EK202122849586</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>42</td>\n      <td>1</td>\n      <td>1</td>\n      <td>RAZONAMIENTO CUANTITATIVO</td>\n      <td>77</td>\n      <td>1</td>\n      <td>2</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>272</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1083039156</td>\n      <td>WILLIAM DAVID DE LIMA CORREA</td>\n      <td>EK202120078279</td>\n      <td>Estudiante</td>\n      <td>1273</td>\n      <td>INGENIERIA CIVIL</td>\n      <td>...</td>\n      <td>25</td>\n      <td>INGENIERÍA CIVIL Y AFINES</td>\n      <td>57</td>\n      <td>1</td>\n      <td>1</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>273</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1083039156</td>\n      <td>WILLIAM DAVID DE LIMA CORREA</td>\n      <td>EK202120078279</td>\n      <td>Estudiante</td>\n      <td>1273</td>\n      <td>INGENIERIA CIVIL</td>\n      <td>...</td>\n      <td>25</td>\n      <td>INGENIERÍA CIVIL Y AFINES</td>\n      <td>57</td>\n      <td>1</td>\n      <td>1</td>\n      <td>COMUNICACIÓN ESCRITA</td>\n      <td>104</td>\n      <td>1</td>\n      <td>13</td>\n      <td>11</td>\n    </tr>\n    <tr>\n      <th>276</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1083039156</td>\n      <td>WILLIAM DAVID DE LIMA CORREA</td>\n      <td>EK202120078279</td>\n      <td>Estudiante</td>\n      <td>1273</td>\n      <td>INGENIERIA CIVIL</td>\n      <td>...</td>\n      <td>25</td>\n      <td>INGENIERÍA CIVIL Y AFINES</td>\n      <td>57</td>\n      <td>1</td>\n      <td>1</td>\n      <td>INGLÉS</td>\n      <td>0</td>\n      <td>A1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>277</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1083039156</td>\n      <td>WILLIAM DAVID DE LIMA CORREA</td>\n      <td>EK202120078279</td>\n      <td>Estudiante</td>\n      <td>1273</td>\n      <td>INGENIERIA CIVIL</td>\n      <td>...</td>\n      <td>25</td>\n      <td>INGENIERÍA CIVIL Y AFINES</td>\n      <td>57</td>\n      <td>1</td>\n      <td>1</td>\n      <td>LECTURA CRÍTICA</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>278</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1083039156</td>\n      <td>WILLIAM DAVID DE LIMA CORREA</td>\n      <td>EK202120078279</td>\n      <td>Estudiante</td>\n      <td>1273</td>\n      <td>INGENIERIA CIVIL</td>\n      <td>...</td>\n      <td>25</td>\n      <td>INGENIERÍA CIVIL Y AFINES</td>\n      <td>57</td>\n      <td>1</td>\n      <td>1</td>\n      <td>RAZONAMIENTO CUANTITATIVO</td>\n      <td>180</td>\n      <td>3</td>\n      <td>86</td>\n      <td>55</td>\n    </tr>\n    <tr>\n      <th>12717</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1234095944</td>\n      <td>INES MARCELA SUAREZ ROJAS</td>\n      <td>EK202122265494</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>56</td>\n      <td>1</td>\n      <td>1</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>12718</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1234095944</td>\n      <td>INES MARCELA SUAREZ ROJAS</td>\n      <td>EK202122265494</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>56</td>\n      <td>1</td>\n      <td>1</td>\n      <td>COMUNICACIÓN ESCRITA</td>\n      <td>176</td>\n      <td>3</td>\n      <td>90</td>\n      <td>85</td>\n    </tr>\n    <tr>\n      <th>12720</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1234095944</td>\n      <td>INES MARCELA SUAREZ ROJAS</td>\n      <td>EK202122265494</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>56</td>\n      <td>1</td>\n      <td>1</td>\n      <td>INGLÉS</td>\n      <td>0</td>\n      <td>A1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>12722</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1234095944</td>\n      <td>INES MARCELA SUAREZ ROJAS</td>\n      <td>EK202122265494</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>56</td>\n      <td>1</td>\n      <td>1</td>\n      <td>LECTURA CRÍTICA</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>12723</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1234095944</td>\n      <td>INES MARCELA SUAREZ ROJAS</td>\n      <td>EK202122265494</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>56</td>\n      <td>1</td>\n      <td>1</td>\n      <td>RAZONAMIENTO CUANTITATIVO</td>\n      <td>104</td>\n      <td>1</td>\n      <td>14</td>\n      <td>15</td>\n    </tr>\n    <tr>\n      <th>38882</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1045744810</td>\n      <td>LAURA CECILIA NAME CAMARGO</td>\n      <td>EK202250499418</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>197</td>\n      <td>98</td>\n      <td>97</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>119</td>\n      <td>1</td>\n      <td>26</td>\n      <td>16</td>\n    </tr>\n    <tr>\n      <th>38883</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1045744810</td>\n      <td>LAURA CECILIA NAME CAMARGO</td>\n      <td>EK202250499418</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>197</td>\n      <td>98</td>\n      <td>97</td>\n      <td>COMUNICACIÓN ESCRITA</td>\n      <td>186</td>\n      <td>4</td>\n      <td>97</td>\n      <td>94</td>\n    </tr>\n    <tr>\n      <th>38886</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1045744810</td>\n      <td>LAURA CECILIA NAME CAMARGO</td>\n      <td>EK202250499418</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>197</td>\n      <td>98</td>\n      <td>97</td>\n      <td>INGLÉS</td>\n      <td>300</td>\n      <td>B2</td>\n      <td>100</td>\n      <td>100</td>\n    </tr>\n    <tr>\n      <th>38888</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1045744810</td>\n      <td>LAURA CECILIA NAME CAMARGO</td>\n      <td>EK202250499418</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>197</td>\n      <td>98</td>\n      <td>97</td>\n      <td>LECTURA CRÍTICA</td>\n      <td>197</td>\n      <td>3</td>\n      <td>94</td>\n      <td>90</td>\n    </tr>\n    <tr>\n      <th>38889</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1045744810</td>\n      <td>LAURA CECILIA NAME CAMARGO</td>\n      <td>EK202250499418</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>197</td>\n      <td>98</td>\n      <td>97</td>\n      <td>RAZONAMIENTO CUANTITATIVO</td>\n      <td>181</td>\n      <td>3</td>\n      <td>85</td>\n      <td>93</td>\n    </tr>\n    <tr>\n      <th>33159</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-1</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1083039156</td>\n      <td>WILLIAM DAVID DE LIMA CORREA</td>\n      <td>EK202220941922</td>\n      <td>Estudiante</td>\n      <td>1273</td>\n      <td>INGENIERIA CIVIL</td>\n      <td>...</td>\n      <td>25</td>\n      <td>INGENIERÍA CIVIL Y AFINES</td>\n      <td>164</td>\n      <td>78</td>\n      <td>62</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>149</td>\n      <td>2</td>\n      <td>53</td>\n      <td>44</td>\n    </tr>\n    <tr>\n      <th>33160</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-1</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1083039156</td>\n      <td>WILLIAM DAVID DE LIMA CORREA</td>\n      <td>EK202220941922</td>\n      <td>Estudiante</td>\n      <td>1273</td>\n      <td>INGENIERIA CIVIL</td>\n      <td>...</td>\n      <td>25</td>\n      <td>INGENIERÍA CIVIL Y AFINES</td>\n      <td>164</td>\n      <td>78</td>\n      <td>62</td>\n      <td>COMUNICACIÓN ESCRITA</td>\n      <td>148</td>\n      <td>2</td>\n      <td>59</td>\n      <td>56</td>\n    </tr>\n    <tr>\n      <th>33161</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-1</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1083039156</td>\n      <td>WILLIAM DAVID DE LIMA CORREA</td>\n      <td>EK202220941922</td>\n      <td>Estudiante</td>\n      <td>1273</td>\n      <td>INGENIERIA CIVIL</td>\n      <td>...</td>\n      <td>25</td>\n      <td>INGENIERÍA CIVIL Y AFINES</td>\n      <td>164</td>\n      <td>78</td>\n      <td>62</td>\n      <td>INGLÉS</td>\n      <td>203</td>\n      <td>B2</td>\n      <td>95</td>\n      <td>95</td>\n    </tr>\n    <tr>\n      <th>33162</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-1</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1083039156</td>\n      <td>WILLIAM DAVID DE LIMA CORREA</td>\n      <td>EK202220941922</td>\n      <td>Estudiante</td>\n      <td>1273</td>\n      <td>INGENIERIA CIVIL</td>\n      <td>...</td>\n      <td>25</td>\n      <td>INGENIERÍA CIVIL Y AFINES</td>\n      <td>164</td>\n      <td>78</td>\n      <td>62</td>\n      <td>LECTURA CRÍTICA</td>\n      <td>146</td>\n      <td>2</td>\n      <td>46</td>\n      <td>36</td>\n    </tr>\n    <tr>\n      <th>33163</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-1</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1083039156</td>\n      <td>WILLIAM DAVID DE LIMA CORREA</td>\n      <td>EK202220941922</td>\n      <td>Estudiante</td>\n      <td>1273</td>\n      <td>INGENIERIA CIVIL</td>\n      <td>...</td>\n      <td>25</td>\n      <td>INGENIERÍA CIVIL Y AFINES</td>\n      <td>164</td>\n      <td>78</td>\n      <td>62</td>\n      <td>RAZONAMIENTO CUANTITATIVO</td>\n      <td>172</td>\n      <td>3</td>\n      <td>81</td>\n      <td>46</td>\n    </tr>\n    <tr>\n      <th>43971</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1234095944</td>\n      <td>INES MARCELA SUAREZ ROJAS</td>\n      <td>EK202250962662</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>151</td>\n      <td>58</td>\n      <td>51</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>187</td>\n      <td>3</td>\n      <td>89</td>\n      <td>78</td>\n    </tr>\n    <tr>\n      <th>43972</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1234095944</td>\n      <td>INES MARCELA SUAREZ ROJAS</td>\n      <td>EK202250962662</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>151</td>\n      <td>58</td>\n      <td>51</td>\n      <td>COMUNICACIÓN ESCRITA</td>\n      <td>124</td>\n      <td>2</td>\n      <td>29</td>\n      <td>24</td>\n    </tr>\n    <tr>\n      <th>43975</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1234095944</td>\n      <td>INES MARCELA SUAREZ ROJAS</td>\n      <td>EK202250962662</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>151</td>\n      <td>58</td>\n      <td>51</td>\n      <td>INGLÉS</td>\n      <td>171</td>\n      <td>B1</td>\n      <td>68</td>\n      <td>68</td>\n    </tr>\n    <tr>\n      <th>43977</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1234095944</td>\n      <td>INES MARCELA SUAREZ ROJAS</td>\n      <td>EK202250962662</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>151</td>\n      <td>58</td>\n      <td>51</td>\n      <td>LECTURA CRÍTICA</td>\n      <td>174</td>\n      <td>3</td>\n      <td>75</td>\n      <td>65</td>\n    </tr>\n    <tr>\n      <th>43978</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1234095944</td>\n      <td>INES MARCELA SUAREZ ROJAS</td>\n      <td>EK202250962662</td>\n      <td>Estudiante</td>\n      <td>1271</td>\n      <td>DERECHO</td>\n      <td>...</td>\n      <td>59</td>\n      <td>DERECHO Y AFINES</td>\n      <td>151</td>\n      <td>58</td>\n      <td>51</td>\n      <td>RAZONAMIENTO CUANTITATIVO</td>\n      <td>97</td>\n      <td>1</td>\n      <td>7</td>\n      <td>8</td>\n    </tr>\n  </tbody>\n</table>\n<p>30 rows × 21 columns</p>\n</div>\n```\n:::\n:::\n\n\n:::{.callout-important}\nHay 3 estudiantes que repitieron la prueba en 2022, ya que en 2021 obtuvieron varios modulos en 0 puntos.\nNos quedaremos con el ultimo intento.\n:::\n\n::: {.cell execution_count=13}\n``` {.python .cell-code}\n#Guardar en una lista los documentos de los estudiantes que repitieron la prueba\n#De los estudiantes que repitieron las pruebas Saber Pro, vamos a eliminar la primera prueba (2021).\nsam_SET=samND[samND['Documento'].isin(repeated_doc)& (samND['Periodo']=='2021')]\ndoc_to_del= list(sam_SET['Documento'].unique())\ndoc_to_del\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```\n['1083039156', '1234095944', '1045744810']\n```\n:::\n:::\n\n\n::: {.cell execution_count=14}\n``` {.python .cell-code}\nsam_ND=samND[(samND['Periodo']!=2021) & (~samND['Documento'].isin(doc_to_del)) ]\nsam_ND['Documento'].value_counts().max()\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```\n5\n```\n:::\n:::\n\n\n:::{.callout-important}\nYa tenemos listo el dataset para pivotearlo\n:::\n\n::: {.cell execution_count=15}\n``` {.python .cell-code}\nsam['Documento'].nunique() #Debe quedarnos esta cantidad de registros al terminar el pivot.\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```\n4690\n```\n:::\n:::\n\n\n::: {.cell execution_count=16}\n``` {.python .cell-code}\nsamND_copy = samND.copy()\n\n```\n:::\n\n\n::: {.cell execution_count=17}\n``` {.python .cell-code}\nsamND_copy = samND_copy.drop_duplicates(subset='Documento')\nsamND_copy.reset_index(inplace=True, drop=True)\n```\n:::\n\n\n::: {.cell execution_count=18}\n``` {.python .cell-code}\nsamND_copy.sample(5)\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Periodo</th>\n      <th>Aplicacion</th>\n      <th>Examen</th>\n      <th>Tipo_Documento</th>\n      <th>Documento</th>\n      <th>Nombre</th>\n      <th>Numero_Registro</th>\n      <th>Tipo_Evaluado</th>\n      <th>SNIES_Programa</th>\n      <th>Programa</th>\n      <th>...</th>\n      <th>ID_NBC</th>\n      <th>NBC</th>\n      <th>PG</th>\n      <th>Perc_Global</th>\n      <th>Perc_NBC</th>\n      <th>Modulo</th>\n      <th>PM</th>\n      <th>Nivel_Desempeño</th>\n      <th>Perc_Mod</th>\n      <th>Perc_nbc_mod</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>801</th>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1005337407</td>\n      <td>MARIANITA  ORDOÑEZ RUIZ</td>\n      <td>EK202120974964</td>\n      <td>Estudiante</td>\n      <td>90329</td>\n      <td>ARQUITECTURA</td>\n      <td>...</td>\n      <td>18</td>\n      <td>ARQUITECTURA</td>\n      <td>154</td>\n      <td>64</td>\n      <td>58</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>140</td>\n      <td>2</td>\n      <td>45</td>\n      <td>43</td>\n    </tr>\n    <tr>\n      <th>4630</th>\n      <td>2022</td>\n      <td>SABER PRO Y TYT EXTERIOR - 20222</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1002421537</td>\n      <td>SHADIA  BAYTER GUTIERREZ DE PIÑERES</td>\n      <td>EK202260005348</td>\n      <td>Estudiante</td>\n      <td>1276</td>\n      <td>INGENIERIA INDUSTRIAL</td>\n      <td>...</td>\n      <td>30</td>\n      <td>INGENIERÍA INDUSTRIAL Y AFINES</td>\n      <td>145</td>\n      <td>50</td>\n      <td>42</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>137</td>\n      <td>2</td>\n      <td>44</td>\n      <td>41</td>\n    </tr>\n    <tr>\n      <th>3901</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1001947146</td>\n      <td>LUIS ANTONIO CARTAGENA RUIZ</td>\n      <td>EK202250879916</td>\n      <td>Estudiante</td>\n      <td>1273</td>\n      <td>INGENIERIA CIVIL</td>\n      <td>...</td>\n      <td>25</td>\n      <td>INGENIERÍA CIVIL Y AFINES</td>\n      <td>149</td>\n      <td>56</td>\n      <td>40</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>164</td>\n      <td>3</td>\n      <td>71</td>\n      <td>65</td>\n    </tr>\n    <tr>\n      <th>3845</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1002372248</td>\n      <td>HECTOR DE JESUS NOVOA DITA</td>\n      <td>EK202250841007</td>\n      <td>Estudiante</td>\n      <td>3269</td>\n      <td>INGENIERIA ELECTRONICA</td>\n      <td>...</td>\n      <td>29</td>\n      <td>INGENIERÍA ELECTRÓNICA, TELECOMUNICACIONES Y A...</td>\n      <td>167</td>\n      <td>79</td>\n      <td>66</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>153</td>\n      <td>2</td>\n      <td>60</td>\n      <td>53</td>\n    </tr>\n    <tr>\n      <th>4040</th>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>1001856858</td>\n      <td>VALERIA LUCIA CORREA MOVILLA</td>\n      <td>EK202250931618</td>\n      <td>Estudiante</td>\n      <td>102003</td>\n      <td>CONTADURIA PUBLICA</td>\n      <td>...</td>\n      <td>12</td>\n      <td>CONTADURÍA PUBLICA</td>\n      <td>170</td>\n      <td>82</td>\n      <td>94</td>\n      <td>COMPETENCIAS CIUDADANAS</td>\n      <td>140</td>\n      <td>2</td>\n      <td>47</td>\n      <td>58</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 21 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=19}\n``` {.python .cell-code}\n# Pivotear el DataFrame para contar las categorías en cada módulo\npivoted_df = pd.pivot_table(samND, index='Documento', columns='Modulo', values='PM',fill_value='')\npivoted_df\n\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Modulo</th>\n      <th>COMPETENCIAS CIUDADANAS</th>\n      <th>COMUNICACIÓN ESCRITA</th>\n      <th>INGLÉS</th>\n      <th>LECTURA CRÍTICA</th>\n      <th>RAZONAMIENTO CUANTITATIVO</th>\n    </tr>\n    <tr>\n      <th>Documento</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1000047889</th>\n      <td>175.0</td>\n      <td>168.0</td>\n      <td>201.0</td>\n      <td>199.0</td>\n      <td>172.0</td>\n    </tr>\n    <tr>\n      <th>1000076539</th>\n      <td>182.0</td>\n      <td>155.0</td>\n      <td>200.0</td>\n      <td>185.0</td>\n      <td>201.0</td>\n    </tr>\n    <tr>\n      <th>1000148517</th>\n      <td>185.0</td>\n      <td>155.0</td>\n      <td>211.0</td>\n      <td>176.0</td>\n      <td>126.0</td>\n    </tr>\n    <tr>\n      <th>1000154230</th>\n      <td>190.0</td>\n      <td>170.0</td>\n      <td>223.0</td>\n      <td>206.0</td>\n      <td>179.0</td>\n    </tr>\n    <tr>\n      <th>1000185783</th>\n      <td>211.0</td>\n      <td>198.0</td>\n      <td>210.0</td>\n      <td>206.0</td>\n      <td>173.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>771779</th>\n      <td>177.0</td>\n      <td>153.0</td>\n      <td>202.0</td>\n      <td>186.0</td>\n      <td>178.0</td>\n    </tr>\n    <tr>\n      <th>803420</th>\n      <td>90.0</td>\n      <td>160.0</td>\n      <td>152.0</td>\n      <td>124.0</td>\n      <td>123.0</td>\n    </tr>\n    <tr>\n      <th>8797937</th>\n      <td>144.0</td>\n      <td>128.0</td>\n      <td>214.0</td>\n      <td>147.0</td>\n      <td>159.0</td>\n    </tr>\n    <tr>\n      <th>96011609578</th>\n      <td>133.0</td>\n      <td>173.0</td>\n      <td>221.0</td>\n      <td>151.0</td>\n      <td>190.0</td>\n    </tr>\n    <tr>\n      <th>YB6333348</th>\n      <td>135.0</td>\n      <td>124.0</td>\n      <td>208.0</td>\n      <td>164.0</td>\n      <td>127.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>4690 rows × 5 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=20}\n``` {.python .cell-code}\nsam_new=pd.merge(pivoted_df,samND_copy, on='Documento')\nsam_new.drop(['Modulo','PM'],axis=1,inplace=True)\nsam_new\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Documento</th>\n      <th>COMPETENCIAS CIUDADANAS</th>\n      <th>COMUNICACIÓN ESCRITA</th>\n      <th>INGLÉS</th>\n      <th>LECTURA CRÍTICA</th>\n      <th>RAZONAMIENTO CUANTITATIVO</th>\n      <th>Periodo</th>\n      <th>Aplicacion</th>\n      <th>Examen</th>\n      <th>Tipo_Documento</th>\n      <th>...</th>\n      <th>Programa</th>\n      <th>Ciudad</th>\n      <th>ID_NBC</th>\n      <th>NBC</th>\n      <th>PG</th>\n      <th>Perc_Global</th>\n      <th>Perc_NBC</th>\n      <th>Nivel_Desempeño</th>\n      <th>Perc_Mod</th>\n      <th>Perc_nbc_mod</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1000047889</td>\n      <td>175.0</td>\n      <td>168.0</td>\n      <td>201.0</td>\n      <td>199.0</td>\n      <td>172.0</td>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>...</td>\n      <td>NEGOCIOS INTERNACIONALES</td>\n      <td>BARRANQUILLA</td>\n      <td>9</td>\n      <td>ADMINISTRACIÓN</td>\n      <td>183</td>\n      <td>92</td>\n      <td>97</td>\n      <td>3</td>\n      <td>81</td>\n      <td>89</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1000076539</td>\n      <td>182.0</td>\n      <td>155.0</td>\n      <td>200.0</td>\n      <td>185.0</td>\n      <td>201.0</td>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>...</td>\n      <td>MEDICINA</td>\n      <td>BARRANQUILLA</td>\n      <td>45</td>\n      <td>MEDICINA</td>\n      <td>185</td>\n      <td>93</td>\n      <td>78</td>\n      <td>3</td>\n      <td>87</td>\n      <td>67</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1000148517</td>\n      <td>185.0</td>\n      <td>155.0</td>\n      <td>211.0</td>\n      <td>176.0</td>\n      <td>126.0</td>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>...</td>\n      <td>DISEÑO INDUSTRIAL</td>\n      <td>BARRANQUILLA</td>\n      <td>7</td>\n      <td>DISEÑO</td>\n      <td>171</td>\n      <td>84</td>\n      <td>78</td>\n      <td>3</td>\n      <td>89</td>\n      <td>88</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1000154230</td>\n      <td>190.0</td>\n      <td>170.0</td>\n      <td>223.0</td>\n      <td>206.0</td>\n      <td>179.0</td>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>...</td>\n      <td>ADMINISTRACION DE EMPRESAS</td>\n      <td>BARRANQUILLA</td>\n      <td>9</td>\n      <td>ADMINISTRACIÓN</td>\n      <td>194</td>\n      <td>97</td>\n      <td>99</td>\n      <td>3</td>\n      <td>91</td>\n      <td>96</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1000185783</td>\n      <td>211.0</td>\n      <td>198.0</td>\n      <td>210.0</td>\n      <td>206.0</td>\n      <td>173.0</td>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>...</td>\n      <td>COMUNICACION SOCIAL Y PERIODISMO</td>\n      <td>BARRANQUILLA</td>\n      <td>57</td>\n      <td>COMUNICACIÓN SOCIAL, PERIODISMO Y AFINES</td>\n      <td>200</td>\n      <td>98</td>\n      <td>98</td>\n      <td>4</td>\n      <td>99</td>\n      <td>99</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>4685</th>\n      <td>771779</td>\n      <td>177.0</td>\n      <td>153.0</td>\n      <td>202.0</td>\n      <td>186.0</td>\n      <td>178.0</td>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CE</td>\n      <td>...</td>\n      <td>MEDICINA</td>\n      <td>BARRANQUILLA</td>\n      <td>45</td>\n      <td>MEDICINA</td>\n      <td>179</td>\n      <td>90</td>\n      <td>68</td>\n      <td>3</td>\n      <td>83</td>\n      <td>58</td>\n    </tr>\n    <tr>\n      <th>4686</th>\n      <td>803420</td>\n      <td>90.0</td>\n      <td>160.0</td>\n      <td>152.0</td>\n      <td>124.0</td>\n      <td>123.0</td>\n      <td>2021</td>\n      <td>SABER PRO Y TYT EXTERIOR - 20213</td>\n      <td>Saber Pro</td>\n      <td>CE</td>\n      <td>...</td>\n      <td>ARQUITECTURA</td>\n      <td>BARRANQUILLA</td>\n      <td>18</td>\n      <td>ARQUITECTURA</td>\n      <td>130</td>\n      <td>29</td>\n      <td>22</td>\n      <td>1</td>\n      <td>7</td>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>4687</th>\n      <td>8797937</td>\n      <td>144.0</td>\n      <td>128.0</td>\n      <td>214.0</td>\n      <td>147.0</td>\n      <td>159.0</td>\n      <td>2022</td>\n      <td>SABER PRO 2022-2</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>...</td>\n      <td>ADMINISTRACION DE EMPRESAS</td>\n      <td>BARRANQUILLA</td>\n      <td>9</td>\n      <td>ADMINISTRACIÓN</td>\n      <td>158</td>\n      <td>69</td>\n      <td>80</td>\n      <td>2</td>\n      <td>51</td>\n      <td>62</td>\n    </tr>\n    <tr>\n      <th>4688</th>\n      <td>96011609578</td>\n      <td>133.0</td>\n      <td>173.0</td>\n      <td>221.0</td>\n      <td>151.0</td>\n      <td>190.0</td>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>TI</td>\n      <td>...</td>\n      <td>DISEÑO INDUSTRIAL</td>\n      <td>BARRANQUILLA</td>\n      <td>7</td>\n      <td>DISEÑO</td>\n      <td>174</td>\n      <td>86</td>\n      <td>82</td>\n      <td>2</td>\n      <td>38</td>\n      <td>32</td>\n    </tr>\n    <tr>\n      <th>4689</th>\n      <td>YB6333348</td>\n      <td>135.0</td>\n      <td>124.0</td>\n      <td>208.0</td>\n      <td>164.0</td>\n      <td>127.0</td>\n      <td>2021</td>\n      <td>SABER PRO Y TYT EXTERIOR - 20213</td>\n      <td>Saber Pro</td>\n      <td>PE</td>\n      <td>...</td>\n      <td>RELACIONES INTERNACIONALES</td>\n      <td>BARRANQUILLA</td>\n      <td>56</td>\n      <td>CIENCIA POLÍTICA, RELACIONES INTERNACIONALES</td>\n      <td>152</td>\n      <td>61</td>\n      <td>17</td>\n      <td>2</td>\n      <td>40</td>\n      <td>9</td>\n    </tr>\n  </tbody>\n</table>\n<p>4690 rows × 24 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Cargando el historico de matriculados, concatenar columnas comunes\nEsto es para poder cruzar y obtener los codigos, promedio y otra info de nuestro interés\n\n::: {.cell execution_count=21}\n``` {.python .cell-code}\ndirectory = '.'\nfiles = [f for f in os.listdir('.') if f.endswith('.csv') and 'matriculados' in f]\ndfs = [pd.read_csv(f, sep=';', low_memory=False) for f in files]\nlen(dfs)\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```\n8\n```\n:::\n:::\n\n\n::: {.cell execution_count=22}\n``` {.python .cell-code}\nfor i, df in enumerate(dfs):\n    print(f'para df{i}, sus columnas son: \\n {df.columns}')\n    \n```\n\n::: {.cell-output .cell-output-stdout}\n```\npara df0, sus columnas son: \n Index(['Pidm', 'Periodo_Matricula', 'DISCAPACIDAD', 'RETENCION_DB',\n       'FECHA_RETENCION_DB', 'RETENCION_DN', 'FECHA_RETENCION_DN', 'ID',\n       'Apellido', 'Primer_Nombre', 'Segundo_Nombre', 'Edad', 'Sexo',\n       'Tipo_Documento', 'No_Documento', 'Lugar_Expedicion',\n       'Fecha_Expedicion', 'CIUDAD_NACIMIENTO', 'DPTO_NACIMIENTO',\n       'PAIS_NACIMIENTO', 'PAIS_NACIONALIDAD', 'Telefono_Celular',\n       'Telefono_DP', 'estrato', 'TIPO_ESTUDIANTE', 'DESC_TIPO_ESTUDIANTE',\n       'Programa', 'Desc_Programa', 'PERIODO_CATALOGO', 'Tasa', 'Nivel',\n       'PROGRAMA_ANTERIOR', 'Codigo_Programa_2', 'Programa_2',\n       'Nivel_programa_2_code', 'Nivel_programa_2_desc',\n       'Escuela_programa_2_code', 'Escuela_programa_2_desc',\n       'Estado_académico_sobrepaso', 'DESC_DECISION', 'SNP', 'PUNTAJE_GLOBAL',\n       'rango', 'Desc_Bachillerato', 'Ciudad_Bachillerato',\n       'Desc_Dpto_Bachillerato', 'Desc_Pais_Bachillerato', 'Codigo_Dane',\n       'Codigo_Banner', 'COLEGIO_PRIVADO', 'COLEGIO_PUBLICO',\n       'COLEGIO_BILINGUE', 'ATRIBUTOS', 'DESC_UNIVERSIDAD1',\n       'CIUDAD_PAIS_UNIVERSIDAD1', 'IND_PAGO_01_02', 'IND_PAGO_03',\n       'Creditos_Totales_Cursados_PR', 'Puntos_Totales_PR', 'Promedio_PR',\n       'Creditos_Totales_Cursados_PG', 'Puntos_Totales_PG', 'Promedio_PG',\n       'ESTADO_ACADEMICO_CONSULTADO', 'PERIODO_ULT_ESTADO_ACADEMICO',\n       'ULTIMO_ESTADO_ACADEMICO', 'ESTADO_ACAD_SOBREPASO', 'CLASE',\n       'CREDITOS_GANADOS_TOTALES', 'CRED_APROBADOS_TOTALES',\n       'CRED_CURSADOS_PROG_TRANSFER', 'PUNTOS_TRANSFER', 'PROMEDIO_TRANSFER',\n       'IND_SOLO_MAT_INGLES', 'CIUDADANIA', 'FECHA_NACIMIENTO', 'email',\n       'email_part', 'Solo_Mat_Ingles'],\n      dtype='object')\npara df1, sus columnas son: \n Index(['Pidm', 'Periodo_Matricula', 'COD BANNER', 'Apellido', 'Primer_Nombre',\n       'Segundo_Nombre', 'Edad', 'Sexo', 'Tipo_Documento', 'No_Documento',\n       'Lugar_Expedicion', 'Fecha_Expedicion', 'CIUDAD_NACIMIENTO',\n       'DPTO_NACIMIENTO', 'PAIS_NACIMIENTO', 'PAIS_NACIONALIDAD',\n       'Telefono_Celular', 'Telefono_DP', 'estrato', 'TIPO_ESTUDIANTE',\n       'DESC_TIPO_ESTUDIANTE', 'Programa', 'Desc_Programa', 'PERIODO_CATALOGO',\n       'Tasa', 'Nivel', 'PROGRAMA_ANTERIOR', 'Codigo_Programa_2', 'Programa_2',\n       'Nivel_programa_2_code', 'Nivel_programa_2_desc',\n       'Escuela_programa_2_code', 'Escuela_programa_2_desc',\n       'Estado_académico_sobrepaso', 'DESC_DECISION', 'SNP', 'PUNTAJE_GLOBAL',\n       'rango', 'Desc_Bachillerato', 'Ciudad_Bachillerato',\n       'Desc_Dpto_Bachillerato', 'Desc_Pais_Bachillerato', 'Codigo_Dane',\n       'Codigo_Banner', 'COLEGIO_PRIVADO', 'COLEGIO_PUBLICO',\n       'COLEGIO_BILINGUE', 'ATRIBUTOS', 'DESC_UNIVERSIDAD1',\n       'CIUDAD_PAIS_UNIVERSIDAD1', 'IND_PAGO_01_02', 'IND_PAGO_03',\n       'Creditos_Totales_Cursados_PR', 'Puntos_Totales_PR', 'Promedio_PR',\n       'Creditos_Totales_Cursados_PG', 'Puntos_Totales_PG', 'Promedio_PG',\n       'ESTADO_ACADEMICO_CONSULTADO', 'PERIODO_ULT_ESTADO_ACADEMICO',\n       'ULTIMO_ESTADO_ACADEMICO', 'ESTADO_ACAD_SOBREPASO', 'SEMESTRE',\n       'CREDITOS_GANADOS_TOTALES', 'CRED_APROBADOS_TOTALES',\n       'CRED_CURSADOS_PROG_TRANSFER', 'PUNTOS_TRANSFER', 'PROMEDIO_TRANSFER',\n       'IND_SOLO_MAT_INGLES', 'CIUDADANIA', 'FECHA_NACIMIENTO', 'email'],\n      dtype='object')\npara df2, sus columnas son: \n Index(['Pidm', 'Periodo_Matricula', 'DISCAPACIDAD', 'RETENCION_DB',\n       'FECHA_RETENCION_DB', 'RETENCION_DN', 'FECHA_RETENCION_DN', 'ID',\n       'Apellido', 'Primer_Nombre', 'Segundo_Nombre', 'Edad', 'Sexo',\n       'Tipo_Documento', 'No_Documento', 'Lugar_Expedicion',\n       'Fecha_Expedicion', 'CIUDAD_NACIMIENTO', 'DPTO_NACIMIENTO',\n       'PAIS_NACIMIENTO', 'PAIS_NACIONALIDAD', 'Telefono_Celular',\n       'Telefono_DP', 'estrato', 'TIPO_ESTUDIANTE', 'DESC_TIPO_ESTUDIANTE',\n       'Programa', 'Desc_Programa', 'PERIODO_CATALOGO', 'Tasa', 'Nivel',\n       'PROGRAMA_ANTERIOR', 'Codigo_Programa_2', 'Programa_2',\n       'Nivel_programa_2_code', 'Nivel_programa_2_desc',\n       'Escuela_programa_2_code', 'Escuela_programa_2_desc',\n       'Estado_académico_sobrepaso', 'DESC_DECISION', 'SNP', 'PUNTAJE_GLOBAL',\n       'rango', 'Desc_Bachillerato', 'Ciudad_Bachillerato',\n       'Desc_Dpto_Bachillerato', 'Desc_Pais_Bachillerato', 'Codigo_Dane',\n       'Codigo_Banner', 'COLEGIO_PRIVADO', 'COLEGIO_PUBLICO',\n       'COLEGIO_BILINGUE', 'ATRIBUTOS', 'DESC_UNIVERSIDAD1',\n       'CIUDAD_PAIS_UNIVERSIDAD1', 'IND_PAGO_01_02', 'IND_PAGO_03',\n       'Creditos_Totales_Cursados_PR', 'Puntos_Totales_PR', 'Promedio_PR',\n       'Creditos_Totales_Cursados_PG', 'Puntos_Totales_PG', 'Promedio_PG',\n       'ESTADO_ACADEMICO_CONSULTADO', 'PERIODO_ULT_ESTADO_ACADEMICO',\n       'ULTIMO_ESTADO_ACADEMICO', 'ESTADO_ACAD_SOBREPASO', 'CLASE',\n       'CREDITOS_GANADOS_TOTALES', 'CRED_APROBADOS_TOTALES',\n       'CRED_CURSADOS_PROG_TRANSFER', 'PUNTOS_TRANSFER', 'PROMEDIO_TRANSFER',\n       'IND_SOLO_MAT_INGLES', 'CIUDADANIA', 'FECHA_NACIMIENTO', 'email',\n       'email_part'],\n      dtype='object')\npara df3, sus columnas son: \n Index(['Pidm', 'Periodo_Matricula', 'DISCAPACIDAD', 'RETENCION_DB',\n       'FECHA_RETENCION_DB', 'RETENCION_DN', 'FECHA_RETENCION_DN', 'ID',\n       'Apellido', 'Primer_Nombre', 'Segundo_Nombre', 'Edad', 'Sexo',\n       'Tipo_Documento', 'No_Documento', 'Lugar_Expedicion',\n       'Fecha_Expedicion', 'CIUDAD_NACIMIENTO', 'DPTO_NACIMIENTO',\n       'PAIS_NACIMIENTO', 'PAIS_NACIONALIDAD', 'Telefono_Celular',\n       'Telefono_DP', 'estrato', 'TIPO_ESTUDIANTE', 'DESC_TIPO_ESTUDIANTE',\n       'Programa', 'Desc_Programa', 'PERIODO_CATALOGO', 'Tasa', 'Nivel',\n       'PROGRAMA_ANTERIOR', 'Codigo_Programa_2', 'Programa_2',\n       'Nivel_programa_2_code', 'Nivel_programa_2_desc',\n       'Escuela_programa_2_code', 'Escuela_programa_2_desc',\n       'Estado_académico_sobrepaso', 'DESC_DECISION', 'SNP', 'PUNTAJE_GLOBAL',\n       'rango', 'Desc_Bachillerato', 'Ciudad_Bachillerato',\n       'Desc_Dpto_Bachillerato', 'Desc_Pais_Bachillerato', 'Codigo_Dane',\n       'Codigo_Banner', 'COLEGIO_PRIVADO', 'COLEGIO_PUBLICO',\n       'COLEGIO_BILINGUE', 'ATRIBUTOS', 'DESC_UNIVERSIDAD1',\n       'CIUDAD_PAIS_UNIVERSIDAD1', 'IND_PAGO_01_02', 'IND_PAGO_03',\n       'Creditos_Totales_Cursados_PR', 'Puntos_Totales_PR', 'Promedio_PR',\n       'Creditos_Totales_Cursados_PG', 'Puntos_Totales_PG', 'Promedio_PG',\n       'ESTADO_ACADEMICO_CONSULTADO', 'PERIODO_ULT_ESTADO_ACADEMICO',\n       'ULTIMO_ESTADO_ACADEMICO', 'ESTADO_ACAD_SOBREPASO', 'CLASE',\n       'CREDITOS_GANADOS_TOTALES', 'CRED_APROBADOS_TOTALES',\n       'CRED_CURSADOS_PROG_TRANSFER', 'PUNTOS_TRANSFER', 'PROMEDIO_TRANSFER',\n       'IND_SOLO_MAT_INGLES', 'CIUDADANIA', 'FECHA_NACIMIENTO', 'email',\n       'email_part'],\n      dtype='object')\npara df4, sus columnas son: \n Index(['Periodo_Matricula', 'ID', 'Apellido', 'Primer_Nombre',\n       'Segundo_Nombre', 'Edad', 'Sexo', 'Tipo_Documento', 'No_Documento',\n       'Lugar_Expedicion', 'Fecha_Expedicion', 'CIUDAD_NACIMIENTO',\n       'DPTO_NACIMIENTO', 'PAIS_NACIMIENTO', 'PAIS_NACIONALIDAD',\n       'Telefono_Celular', 'Telefono_DP', 'estrato', 'TIPO_ESTUDIANTE',\n       'DESC_TIPO_ESTUDIANTE', 'Programa', 'Desc_Programa', 'PERIODO_CATALOGO',\n       'Tasa', 'Nivel', 'PROGRAMA_ANTERIOR', 'Codigo_Programa_2', 'Programa_2',\n       'Nivel_programa_2_code', 'Nivel_programa_2_desc',\n       'Escuela_programa_2_code', 'Escuela_programa_2_desc',\n       'Estado_académico_sobrepaso', 'DESC_DECISION', 'SNP', 'PUNTAJE_GLOBAL',\n       'rango', 'Desc_Bachillerato', 'Ciudad_Bachillerato',\n       'Desc_Dpto_Bachillerato', 'Desc_Pais_Bachillerato', 'Codigo_Dane',\n       'Codigo_Banner', 'COLEGIO_PRIVADO', 'COLEGIO_PUBLICO',\n       'COLEGIO_BILINGUE', 'ATRIBUTOS', 'DESC_UNIVERSIDAD1',\n       'CIUDAD_PAIS_UNIVERSIDAD1', 'IND_PAGO_01_02', 'IND_PAGO_03',\n       'Creditos_Totales_Cursados_PR', 'Puntos_Totales_PR', 'Promedio_PR',\n       'Creditos_Totales_Cursados_PG', 'Puntos_Totales_PG', 'Promedio_PG',\n       'ESTADO_ACADEMICO_CONSULTADO', 'PERIODO_ULT_ESTADO_ACADEMICO',\n       'ULTIMO_ESTADO_ACADEMICO', 'ESTADO_ACAD_SOBREPASO', 'CLASE',\n       'CREDITOS_GANADOS_TOTALES', 'CRED_APROBADOS_TOTALES',\n       'CRED_CURSADOS_PROG_TRANSFER', 'PUNTOS_TRANSFER', 'PROMEDIO_TRANSFER',\n       'IND_SOLO_MAT_INGLES', 'CIUDADANIA', 'FECHA_NACIMIENTO', 'email',\n       'email_part', 'Solo_Mat_Ingles'],\n      dtype='object')\npara df5, sus columnas son: \n Index(['Pidm', 'Periodo_Matricula', 'DISCAPACIDAD', 'RETENCION_DB',\n       'FECHA_RETENCION_DB', 'RETENCION_DN', 'FECHA_RETENCION_DN', 'ID',\n       'Apellido', 'Primer_Nombre', 'Segundo_Nombre', 'Edad', 'Sexo',\n       'Tipo_Documento', 'No_Documento', 'Lugar_Expedicion',\n       'Fecha_Expedicion', 'CIUDAD_NACIMIENTO', 'DPTO_NACIMIENTO',\n       'PAIS_NACIMIENTO', 'PAIS_NACIONALIDAD', 'Telefono_Celular',\n       'Telefono_DP', 'estrato', 'TIPO_ESTUDIANTE', 'DESC_TIPO_ESTUDIANTE',\n       'Programa', 'Desc_Programa', 'PERIODO_CATALOGO', 'Tasa', 'Nivel',\n       'PROGRAMA_ANTERIOR', 'Codigo_Programa_2', 'Programa_2',\n       'Nivel_programa_2_code', 'Nivel_programa_2_desc',\n       'Escuela_programa_2_code', 'Escuela_programa_2_desc',\n       'Estado_académico_sobrepaso', 'DESC_DECISION', 'SNP', 'PUNTAJE_GLOBAL',\n       'rango', 'Desc_Bachillerato', 'Ciudad_Bachillerato',\n       'Desc_Dpto_Bachillerato', 'Desc_Pais_Bachillerato', 'Codigo_Dane',\n       'Codigo_Banner', 'COLEGIO_PRIVADO', 'COLEGIO_PUBLICO',\n       'COLEGIO_BILINGUE', 'ATRIBUTOS', 'DESC_UNIVERSIDAD1',\n       'CIUDAD_PAIS_UNIVERSIDAD1', 'IND_PAGO_01_02', 'IND_PAGO_03',\n       'Creditos_Totales_Cursados_PR', 'Puntos_Totales_PR', 'Promedio_PR',\n       'Creditos_Totales_Cursados_PG', 'Puntos_Totales_PG', 'Promedio_PG',\n       'ESTADO_ACADEMICO_CONSULTADO', 'PERIODO_ULT_ESTADO_ACADEMICO',\n       'ULTIMO_ESTADO_ACADEMICO', 'ESTADO_ACAD_SOBREPASO', 'CLASE',\n       'CREDITOS_GANADOS_TOTALES', 'CRED_APROBADOS_TOTALES',\n       'CRED_CURSADOS_PROG_TRANSFER', 'PUNTOS_TRANSFER', 'PROMEDIO_TRANSFER',\n       'IND_SOLO_MAT_INGLES', 'CIUDADANIA', 'FECHA_NACIMIENTO', 'email',\n       'email_part', 'Solo_Mat_Ingles'],\n      dtype='object')\npara df6, sus columnas son: \n Index(['Pidm', 'Periodo_Matricula', 'DISCAPACIDAD', 'RETENCION_DB',\n       'FECHA_RETENCION_DB', 'RETENCION_DN', 'FECHA_RETENCION_DN', 'ID',\n       'Apellido', 'Primer_Nombre', 'Segundo_Nombre', 'Edad', 'Sexo',\n       'Tipo_Documento', 'No_Documento', 'Lugar_Expedicion',\n       'Fecha_Expedicion', 'CIUDAD_NACIMIENTO', 'DPTO_NACIMIENTO',\n       'PAIS_NACIMIENTO', 'PAIS_NACIONALIDAD', 'Telefono_Celular',\n       'Telefono_DP', 'estrato', 'TIPO_ESTUDIANTE', 'DESC_TIPO_ESTUDIANTE',\n       'Programa', 'Desc_Programa', 'PERIODO_CATALOGO', 'Tasa', 'Nivel',\n       'PROGRAMA_ANTERIOR', 'Codigo_Programa_2', 'Programa_2',\n       'Nivel_programa_2_code', 'Nivel_programa_2_desc',\n       'Escuela_programa_2_code', 'Escuela_programa_2_desc',\n       'Estado_académico_sobrepaso', 'DESC_DECISION', 'SNP', 'PUNTAJE_GLOBAL',\n       'rango', 'Desc_Bachillerato', 'Ciudad_Bachillerato',\n       'Desc_Dpto_Bachillerato', 'Desc_Pais_Bachillerato', 'Codigo_Dane',\n       'Codigo_Banner', 'COLEGIO_PRIVADO', 'COLEGIO_PUBLICO',\n       'COLEGIO_BILINGUE', 'ATRIBUTOS', 'DESC_UNIVERSIDAD1',\n       'CIUDAD_PAIS_UNIVERSIDAD1', 'IND_PAGO_01_02', 'IND_PAGO_03',\n       'Creditos_Totales_Cursados_PR', 'Puntos_Totales_PR', 'Promedio_PR',\n       'Creditos_Totales_Cursados_PG', 'Puntos_Totales_PG', 'Promedio_PG',\n       'ESTADO_ACADEMICO_CONSULTADO', 'PERIODO_ULT_ESTADO_ACADEMICO',\n       'ULTIMO_ESTADO_ACADEMICO', 'ESTADO_ACAD_SOBREPASO', 'CLASE',\n       'CREDITOS_GANADOS_TOTALES', 'CRED_APROBADOS_TOTALES',\n       'CRED_CURSADOS_PROG_TRANSFER', 'PUNTOS_TRANSFER', 'PROMEDIO_TRANSFER',\n       'IND_SOLO_MAT_INGLES', 'CIUDADANIA', 'FECHA_NACIMIENTO', 'email',\n       'email_part', 'Solo_Mat_Ingles'],\n      dtype='object')\npara df7, sus columnas son: \n Index(['Pidm', 'Periodo_Matricula', 'DISCAPACIDAD', 'RETENCION_DB',\n       'FECHA_RETENCION_DB', 'RETENCION_DN', 'FECHA_RETENCION_DN', 'ID',\n       'Apellido', 'Primer_Nombre', 'Segundo_Nombre', 'Edad', 'Sexo',\n       'Tipo_Documento', 'No_Documento', 'Lugar_Expedicion',\n       'Fecha_Expedicion', 'CIUDAD_NACIMIENTO', 'DPTO_NACIMIENTO',\n       'PAIS_NACIMIENTO', 'PAIS_NACIONALIDAD', 'Telefono_Celular',\n       'Telefono_DP', 'estrato', 'TIPO_ESTUDIANTE', 'DESC_TIPO_ESTUDIANTE',\n       'Programa', 'Desc_Programa', 'PERIODO_CATALOGO', 'Tasa', 'Nivel',\n       'PROGRAMA_ANTERIOR', 'Codigo_Programa_2', 'Programa_2',\n       'Nivel_programa_2_code', 'Nivel_programa_2_desc',\n       'Escuela_programa_2_code', 'Escuela_programa_2_desc',\n       'Estado_académico_sobrepaso', 'DESC_DECISION', 'SNP', 'PUNTAJE_GLOBAL',\n       'rango', 'Desc_Bachillerato', 'Ciudad_Bachillerato',\n       'Desc_Dpto_Bachillerato', 'Desc_Pais_Bachillerato', 'Codigo_Dane',\n       'Codigo_Banner', 'COLEGIO_PRIVADO', 'COLEGIO_PUBLICO',\n       'COLEGIO_BILINGUE', 'ATRIBUTOS', 'DESC_UNIVERSIDAD1',\n       'CIUDAD_PAIS_UNIVERSIDAD1', 'IND_PAGO_01_02', 'IND_PAGO_03',\n       'Creditos_Totales_Cursados_PR', 'Puntos_Totales_PR', 'Promedio_PR',\n       'Creditos_Totales_Cursados_PG', 'Puntos_Totales_PG', 'Promedio_PG',\n       'ESTADO_ACADEMICO_CONSULTADO', 'PERIODO_ULT_ESTADO_ACADEMICO',\n       'ULTIMO_ESTADO_ACADEMICO', 'ESTADO_ACAD_SOBREPASO', 'CLASE',\n       'CREDITOS_GANADOS_TOTALES', 'CRED_APROBADOS_TOTALES',\n       'CRED_CURSADOS_PROG_TRANSFER', 'PUNTOS_TRANSFER', 'PROMEDIO_TRANSFER',\n       'IND_SOLO_MAT_INGLES', 'CIUDADANIA', 'FECHA_NACIMIENTO', 'email',\n       'email_part', 'Solo_Mat_Ingles', 'Créditos Matriculados'],\n      dtype='object')\n```\n:::\n:::\n\n\n::: {.cell execution_count=23}\n``` {.python .cell-code}\nrename_col(dfs[1],'COD BANNER','ID')\n```\n\n::: {.cell-output .cell-output-display}\n<p style='font-size:18px;'>Ejecutamos una función personalizada para cambiar el nombre de la columna <code>COD BANNER</code> por <code>ID</code> para evitar posibles errores en los procesos posteriores.</p>\n:::\n:::\n\n\n::: {.cell execution_count=24}\n``` {.python .cell-code}\ncommon_columns = set(dfs[0].columns)\nfor df in dfs[1:]:\n    common_columns.intersection_update(df.columns)\n\n# Convertir el conjunto a una lista y mostrar las columnas comunes\ncommon_columns = list(common_columns)\nprint(\"Columnas comunes:\", common_columns)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nColumnas comunes: ['Segundo_Nombre', 'Desc_Programa', 'COLEGIO_PUBLICO', 'Edad', 'DESC_UNIVERSIDAD1', 'Telefono_DP', 'No_Documento', 'ID', 'COLEGIO_PRIVADO', 'CREDITOS_GANADOS_TOTALES', 'Desc_Dpto_Bachillerato', 'Apellido', 'SNP', 'Periodo_Matricula', 'Ciudad_Bachillerato', 'DESC_DECISION', 'Puntos_Totales_PG', 'Programa_2', 'PAIS_NACIMIENTO', 'PERIODO_ULT_ESTADO_ACADEMICO', 'PERIODO_CATALOGO', 'CIUDAD_PAIS_UNIVERSIDAD1', 'Desc_Bachillerato', 'Lugar_Expedicion', 'rango', 'PROMEDIO_TRANSFER', 'Nivel', 'PROGRAMA_ANTERIOR', 'Escuela_programa_2_desc', 'PUNTAJE_GLOBAL', 'ATRIBUTOS', 'Promedio_PR', 'PUNTOS_TRANSFER', 'Nivel_programa_2_code', 'Desc_Pais_Bachillerato', 'Escuela_programa_2_code', 'IND_PAGO_01_02', 'Creditos_Totales_Cursados_PR', 'COLEGIO_BILINGUE', 'ULTIMO_ESTADO_ACADEMICO', 'CRED_APROBADOS_TOTALES', 'IND_SOLO_MAT_INGLES', 'CRED_CURSADOS_PROG_TRANSFER', 'Primer_Nombre', 'email', 'estrato', 'Fecha_Expedicion', 'CIUDAD_NACIMIENTO', 'Sexo', 'PAIS_NACIONALIDAD', 'DPTO_NACIMIENTO', 'Estado_académico_sobrepaso', 'ESTADO_ACADEMICO_CONSULTADO', 'DESC_TIPO_ESTUDIANTE', 'Puntos_Totales_PR', 'Nivel_programa_2_desc', 'Tipo_Documento', 'FECHA_NACIMIENTO', 'Tasa', 'IND_PAGO_03', 'CIUDADANIA', 'Programa', 'Codigo_Banner', 'Creditos_Totales_Cursados_PG', 'ESTADO_ACAD_SOBREPASO', 'Telefono_Celular', 'Codigo_Programa_2', 'Promedio_PG', 'TIPO_ESTUDIANTE', 'Codigo_Dane']\n```\n:::\n:::\n\n\n::: {.cell execution_count=25}\n``` {.python .cell-code}\nlen(common_columns)\n```\n\n::: {.cell-output .cell-output-display execution_count=25}\n```\n70\n```\n:::\n:::\n\n\n::: {.cell execution_count=26}\n``` {.python .cell-code}\ndfs_common = [df[common_columns] for df in dfs]\nconcatenated_df = pd.concat(dfs_common, ignore_index=True)\nconcatenated_df\n```\n\n::: {.cell-output .cell-output-display execution_count=26}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Segundo_Nombre</th>\n      <th>Desc_Programa</th>\n      <th>COLEGIO_PUBLICO</th>\n      <th>Edad</th>\n      <th>DESC_UNIVERSIDAD1</th>\n      <th>Telefono_DP</th>\n      <th>No_Documento</th>\n      <th>ID</th>\n      <th>COLEGIO_PRIVADO</th>\n      <th>CREDITOS_GANADOS_TOTALES</th>\n      <th>...</th>\n      <th>CIUDADANIA</th>\n      <th>Programa</th>\n      <th>Codigo_Banner</th>\n      <th>Creditos_Totales_Cursados_PG</th>\n      <th>ESTADO_ACAD_SOBREPASO</th>\n      <th>Telefono_Celular</th>\n      <th>Codigo_Programa_2</th>\n      <th>Promedio_PG</th>\n      <th>TIPO_ESTUDIANTE</th>\n      <th>Codigo_Dane</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Andres</td>\n      <td>Contaduría Pública</td>\n      <td>NaN</td>\n      <td>31.0</td>\n      <td>NaN</td>\n      <td>3509329</td>\n      <td>1143116504</td>\n      <td>200012054</td>\n      <td>Y</td>\n      <td>70.0</td>\n      <td>...</td>\n      <td>C</td>\n      <td>PRCONTADURIA</td>\n      <td>42218.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>3007260020</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>9</td>\n      <td>3,08001E+11</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Miguel</td>\n      <td>Ciencia Política y Gobierno</td>\n      <td>NaN</td>\n      <td>33.0</td>\n      <td>NaN</td>\n      <td>3990777</td>\n      <td>1140825678</td>\n      <td>200014712</td>\n      <td>Y</td>\n      <td>135.0</td>\n      <td>...</td>\n      <td>C</td>\n      <td>PCIENPOLIGOB</td>\n      <td>120394.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>3043990777</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>9</td>\n      <td>3,08001E+11</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Rafael</td>\n      <td>Ingeniería Industrial</td>\n      <td>NaN</td>\n      <td>21.0</td>\n      <td>NaN</td>\n      <td>3196608</td>\n      <td>1001779209</td>\n      <td>200021778</td>\n      <td>Y</td>\n      <td>146.0</td>\n      <td>...</td>\n      <td>C</td>\n      <td>PINGINDUSTRL</td>\n      <td>3202.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>3017903126</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>9</td>\n      <td>4,08573E+11</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Margarita</td>\n      <td>Filosofía y Humanidades</td>\n      <td>NaN</td>\n      <td>31.0</td>\n      <td>NaN</td>\n      <td>3163248011</td>\n      <td>1140827074</td>\n      <td>200022740</td>\n      <td>Y</td>\n      <td>135.0</td>\n      <td>...</td>\n      <td>C</td>\n      <td>PFILOSOHUMAN</td>\n      <td>35675.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>3163248011</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>9</td>\n      <td>3,08001E+11</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Del Carmen</td>\n      <td>Psicología</td>\n      <td>NaN</td>\n      <td>53.0</td>\n      <td>1713-Universidad del Norte</td>\n      <td>3575688</td>\n      <td>32605496</td>\n      <td>32605496</td>\n      <td>Y</td>\n      <td>130.0</td>\n      <td>...</td>\n      <td>C</td>\n      <td>PRPSICOLOGIA</td>\n      <td>3459.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>3135622471</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>9</td>\n      <td>3,08001E+11</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>100903</th>\n      <td>NaN</td>\n      <td>Psicología</td>\n      <td>NaN</td>\n      <td>17.0</td>\n      <td>NaN</td>\n      <td>3871607</td>\n      <td>1042243347</td>\n      <td>200185959</td>\n      <td>Y</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>C</td>\n      <td>PRPSICOLOGIA</td>\n      <td>3186.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>3014518711</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1</td>\n      <td>3,08573E+11</td>\n    </tr>\n    <tr>\n      <th>100904</th>\n      <td>Sofia</td>\n      <td>Psicología</td>\n      <td>NaN</td>\n      <td>19.0</td>\n      <td>NaN</td>\n      <td>3034707</td>\n      <td>1001818978</td>\n      <td>200191580</td>\n      <td>Y</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>C</td>\n      <td>PRPSICOLOGIA</td>\n      <td>53363.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>3146785825</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1</td>\n      <td>4,47001E+11</td>\n    </tr>\n    <tr>\n      <th>100905</th>\n      <td>NaN</td>\n      <td>Psicología</td>\n      <td>NaN</td>\n      <td>18.0</td>\n      <td>NaN</td>\n      <td>3002092633</td>\n      <td>1043963166</td>\n      <td>200184933</td>\n      <td>Y</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>C</td>\n      <td>PRPSICOLOGIA</td>\n      <td>62455.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>3002092633</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1</td>\n      <td>3,13001E+11</td>\n    </tr>\n    <tr>\n      <th>100906</th>\n      <td>Lisseth</td>\n      <td>Psicología</td>\n      <td>NaN</td>\n      <td>17.0</td>\n      <td>NaN</td>\n      <td>3006461753</td>\n      <td>1043118257</td>\n      <td>200182845</td>\n      <td>Y</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>C</td>\n      <td>PRPSICOLOGIA</td>\n      <td>120535.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>3006461753</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1</td>\n      <td>3,08758E+11</td>\n    </tr>\n    <tr>\n      <th>100907</th>\n      <td>Maria</td>\n      <td>Psicología</td>\n      <td>NaN</td>\n      <td>18.0</td>\n      <td>NaN</td>\n      <td>3015522085</td>\n      <td>1048434550</td>\n      <td>200185103</td>\n      <td>Y</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>C</td>\n      <td>PRPSICOLOGIA</td>\n      <td>27011.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>3015522085</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1</td>\n      <td>3,13836E+11</td>\n    </tr>\n  </tbody>\n</table>\n<p>100908 rows × 70 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Cruce de información\n\nVamos a cruzar informacion para obtener datos de promedio y codigo\n\n::: {.cell execution_count=27}\n``` {.python .cell-code}\nrename_col(concatenated_df,'No_Documento', 'Documento')\n```\n\n::: {.cell-output .cell-output-display}\n<p style='font-size:18px;'>Ejecutamos una función personalizada para cambiar el nombre de la columna <code>No_Documento</code> por <code>Documento</code> para evitar posibles errores en los procesos posteriores.</p>\n:::\n:::\n\n\n::: {.cell execution_count=28}\n``` {.python .cell-code}\nsam_new.shape\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n```\n(4690, 24)\n```\n:::\n:::\n\n\n::: {.cell execution_count=29}\n``` {.python .cell-code}\n# Identificar y seleccionar el registro con el mayor valor de 'PUNTAJE_GLOBAL' para cada 'Documento'\nconcatenated_df_unique = concatenated_df.loc[concatenated_df.groupby('Documento')['Periodo_Matricula'].idxmax()]\nconcatenated_df_unique.shape\n\n\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```\n(22261, 70)\n```\n:::\n:::\n\n\n::: {.cell execution_count=30}\n``` {.python .cell-code}\nmerged=pd.merge(sam_new,concatenated_df_unique[\n    [   'Documento',\n        'ID',\n        'PUNTAJE_GLOBAL', \n        'Creditos_Totales_Cursados_PR',\n        'CRED_APROBADOS_TOTALES',\n        'Promedio_PR',\n        'Puntos_Totales_PR',\n        'Periodo_Matricula'\n        ]], on='Documento', how='left')\nprint(merged.shape)\nna_mask = merged['ID'].isna()\nmerged['ID'].isnull().sum()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(4690, 31)\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=30}\n```\n35\n```\n:::\n:::\n\n\n::: {.cell execution_count=31}\n``` {.python .cell-code}\nprint(merged.shape)\nmerged.columns\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(4690, 31)\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=31}\n```\nIndex(['Documento', 'COMPETENCIAS CIUDADANAS', 'COMUNICACIÓN ESCRITA',\n       'INGLÉS', 'LECTURA CRÍTICA', 'RAZONAMIENTO CUANTITATIVO', 'Periodo',\n       'Aplicacion', 'Examen', 'Tipo_Documento', 'Nombre', 'Numero_Registro',\n       'Tipo_Evaluado', 'SNIES_Programa', 'Programa', 'Ciudad', 'ID_NBC',\n       'NBC', 'PG', 'Perc_Global', 'Perc_NBC', 'Nivel_Desempeño', 'Perc_Mod',\n       'Perc_nbc_mod', 'ID', 'PUNTAJE_GLOBAL', 'Creditos_Totales_Cursados_PR',\n       'CRED_APROBADOS_TOTALES', 'Promedio_PR', 'Puntos_Totales_PR',\n       'Periodo_Matricula'],\n      dtype='object')\n```\n:::\n:::\n\n\n::: {.cell execution_count=32}\n``` {.python .cell-code}\nmerged[['Nombre','Documento']][merged['ID'].isnull()]\n```\n\n::: {.cell-output .cell-output-display execution_count=32}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Nombre</th>\n      <th>Documento</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>970</th>\n      <td>GABRIELA  URANGO OVIEDO</td>\n      <td>1002192819</td>\n    </tr>\n    <tr>\n      <th>1960</th>\n      <td>ANDREA VALERIA POSADA PEREZ</td>\n      <td>1010081310</td>\n    </tr>\n    <tr>\n      <th>2140</th>\n      <td>JUAN JOSE CABARCA CHARRIS</td>\n      <td>1010146761</td>\n    </tr>\n    <tr>\n      <th>2200</th>\n      <td>CINDY LORAINE VERGARA ZULUAGA</td>\n      <td>1035753530</td>\n    </tr>\n    <tr>\n      <th>2254</th>\n      <td>CESAR ANDRES SANCHEZ INSIGNARES</td>\n      <td>1043028647</td>\n    </tr>\n    <tr>\n      <th>2315</th>\n      <td>TATIANA MARGARITA RESTREPO CERVANTES</td>\n      <td>1045727778</td>\n    </tr>\n    <tr>\n      <th>2484</th>\n      <td>SEBASTIAN  FLOREZ MANTILLA</td>\n      <td>1050977260</td>\n    </tr>\n    <tr>\n      <th>2523</th>\n      <td>MARIA CAMILA FUENTES REYES</td>\n      <td>1065845458</td>\n    </tr>\n    <tr>\n      <th>2621</th>\n      <td>CAMILA ANDREA MOTTA ROMERO</td>\n      <td>1083041271</td>\n    </tr>\n    <tr>\n      <th>2871</th>\n      <td>ESTEBAN ANDRES REY MONTERO</td>\n      <td>1140890750</td>\n    </tr>\n    <tr>\n      <th>3021</th>\n      <td>ANAISABEL MARGARITA FERNANDEZ ALZAMORA</td>\n      <td>1140899556</td>\n    </tr>\n    <tr>\n      <th>3206</th>\n      <td>NATALIA  CLAVIJO RODRIGUEZ</td>\n      <td>1140903794</td>\n    </tr>\n    <tr>\n      <th>3231</th>\n      <td>CAMILA MARGARITA LORA BERROCAL</td>\n      <td>1140904302</td>\n    </tr>\n    <tr>\n      <th>3438</th>\n      <td>VALENTINA  CABRALES HOYOS</td>\n      <td>1143467922</td>\n    </tr>\n    <tr>\n      <th>3462</th>\n      <td>MATEO  MONTOYA DIAZ</td>\n      <td>1143470152</td>\n    </tr>\n    <tr>\n      <th>3474</th>\n      <td>ANDRÉS FELIPE DELAHOZ SUÁREZ</td>\n      <td>1182802569</td>\n    </tr>\n    <tr>\n      <th>3646</th>\n      <td>ANDREA CAMILA MORALES RANGEL</td>\n      <td>1192796467</td>\n    </tr>\n    <tr>\n      <th>3881</th>\n      <td>MARILIA  DIAZ AYCARDI</td>\n      <td>1193377351</td>\n    </tr>\n    <tr>\n      <th>4141</th>\n      <td>EDUARDO JOSE JIMENEZ JALUBE</td>\n      <td>1234091737</td>\n    </tr>\n    <tr>\n      <th>4411</th>\n      <td>ISAIAS DE JESUS CANTILLO VEGA</td>\n      <td>1234096306</td>\n    </tr>\n    <tr>\n      <th>4522</th>\n      <td>LUIS DAVID BELTRAN BILBAO</td>\n      <td>1234097229</td>\n    </tr>\n    <tr>\n      <th>4558</th>\n      <td>ANDREA LUCIA DLUIS BASTIDAS</td>\n      <td>1234097518</td>\n    </tr>\n    <tr>\n      <th>4665</th>\n      <td>MATTHIS  LAPIERRE</td>\n      <td>17AF30755</td>\n    </tr>\n    <tr>\n      <th>4666</th>\n      <td>LEON  LOEWENGUTH</td>\n      <td>18CK27199</td>\n    </tr>\n    <tr>\n      <th>4667</th>\n      <td>MARIA ISABELLA GONZALEZ RUIZ</td>\n      <td>2000010061</td>\n    </tr>\n    <tr>\n      <th>4668</th>\n      <td>ERWAN  ROSSO</td>\n      <td>22CA01958</td>\n    </tr>\n    <tr>\n      <th>4680</th>\n      <td>GIOSUE RICARDO JURADO BRUNO</td>\n      <td>701936</td>\n    </tr>\n    <tr>\n      <th>4681</th>\n      <td>IVAN ALBERTO WILD RAMIREZ</td>\n      <td>72208384</td>\n    </tr>\n    <tr>\n      <th>4682</th>\n      <td>PIERANGELA  PREVITE NASTASI</td>\n      <td>761223</td>\n    </tr>\n    <tr>\n      <th>4683</th>\n      <td>FRANCESCO  PREVITE NASTASI</td>\n      <td>761224</td>\n    </tr>\n    <tr>\n      <th>4684</th>\n      <td>MARIA DE LOS ANGELES MARTINEZ GONZALEZ</td>\n      <td>761232</td>\n    </tr>\n    <tr>\n      <th>4685</th>\n      <td>LUIS FERNANDO MARTINEZ GONZALEZ</td>\n      <td>771779</td>\n    </tr>\n    <tr>\n      <th>4687</th>\n      <td>FELIPE JOSE CORTISSOZ CARBONELL</td>\n      <td>8797937</td>\n    </tr>\n    <tr>\n      <th>4688</th>\n      <td>ANDREA CAROLINA ZABALA PINZON</td>\n      <td>96011609578</td>\n    </tr>\n    <tr>\n      <th>4689</th>\n      <td>CHIARA  DARI</td>\n      <td>YB6333348</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=33}\n``` {.python .cell-code}\nfaltantes=pd.read_csv('faltantes.csv', sep=\";\")\nfaltantes\n```\n\n::: {.cell-output .cell-output-display execution_count=33}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Nombre</th>\n      <th>Documento</th>\n      <th>ID</th>\n      <th>Tasa</th>\n      <th>Unnamed: 4</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>GABRIELA URANGO OVIEDO</td>\n      <td>1002192819</td>\n      <td>200116269</td>\n      <td>201730.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>ANDREA VALERIA POSADA PEREZ</td>\n      <td>1010081310</td>\n      <td>200048347</td>\n      <td>201710.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>JUAN JOSE CABARCA CHARRIS</td>\n      <td>1010146761</td>\n      <td>200126474</td>\n      <td>201810.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>CINDY LORAINE VERGARA ZULUAGA</td>\n      <td>1035753530</td>\n      <td>200129631</td>\n      <td>201830.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>CESAR ANDRES SANCHEZ INSIGNARES</td>\n      <td>1043028647</td>\n      <td>200095729</td>\n      <td>201630.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>TATIANA MARGARITA RESTREPO CERVANTES</td>\n      <td>1045727778</td>\n      <td>200048757</td>\n      <td>201610.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>SEBASTIAN FLOREZ MANTILLA</td>\n      <td>1050977260</td>\n      <td>200042838</td>\n      <td>201710.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>MARIA CAMILA FUENTES REYES</td>\n      <td>1065845458</td>\n      <td>200090116</td>\n      <td>201630.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>CAMILA ANDREA MOTTA ROMERO</td>\n      <td>1083041271</td>\n      <td>200092002</td>\n      <td>201630.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>ESTEBAN ANDRES REY MONTERO</td>\n      <td>1140890750</td>\n      <td>200064577</td>\n      <td>201430.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>ANAISABEL MARGARITA FERNANDEZ ALZAMORA</td>\n      <td>1140899556</td>\n      <td>200098617</td>\n      <td>201630.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>NATALIA CLAVIJO RODRIGUEZ</td>\n      <td>1140903794</td>\n      <td>200115489</td>\n      <td>201730.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>CAMILA MARGARITA LORA BERROCAL</td>\n      <td>1140904302</td>\n      <td>200104046</td>\n      <td>201810.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>VALENTINA CABRALES HOYOS</td>\n      <td>1143467922</td>\n      <td>200116524</td>\n      <td>201730.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>MATEO MONTOYA DIAZ</td>\n      <td>1143470152</td>\n      <td>200096158</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>ANDRÉS FELIPE DELAHOZ SUÁREZ</td>\n      <td>1182802569</td>\n      <td>200123788</td>\n      <td>201810.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>ANDREA CAMILA MORALES RANGEL</td>\n      <td>1192796467</td>\n      <td>200120808</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>MARILIA DIAZ AYCARDI</td>\n      <td>1193377351</td>\n      <td>200129359</td>\n      <td>201910.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>EDUARDO JOSE JIMENEZ JALUBE</td>\n      <td>1234091737</td>\n      <td>200099653</td>\n      <td>201630.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>ISAIAS DE JESUS CANTILLO VEGA</td>\n      <td>1234096306</td>\n      <td>200106269</td>\n      <td>201710.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>LUIS DAVID BELTRAN BILBAO</td>\n      <td>1234097229</td>\n      <td>200105728</td>\n      <td>201710.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>ANDREA LUCIA DLUIS BASTIDAS</td>\n      <td>1234097518</td>\n      <td>200107500</td>\n      <td>201730.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>MATTHIS LAPIERRE</td>\n      <td>17AF30755</td>\n      <td>200158549</td>\n      <td>202030.0</td>\n      <td>INTERCAMBIO</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>LEON LOEWENGUTH</td>\n      <td>18CK27199</td>\n      <td>200158548</td>\n      <td>202030.0</td>\n      <td>INTERCAMBIO</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>MARIA ISABELLA GONZALEZ RUIZ</td>\n      <td>2000010061</td>\n      <td>200089832</td>\n      <td>202110.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>ERWAN ROSSO</td>\n      <td>22CA01958</td>\n      <td>200192865</td>\n      <td>202230.0</td>\n      <td>INTERCAMBIO</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>GIOSUE RICARDO JURADO BRUNO</td>\n      <td>701936</td>\n      <td>200116704</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>IVAN ALBERTO WILD RAMIREZ</td>\n      <td>72208384</td>\n      <td>72208384</td>\n      <td>202030.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>PIERANGELA PREVITE NASTASI</td>\n      <td>761223</td>\n      <td>200128349</td>\n      <td>201810.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>FRANCESCO PREVITE NASTASI</td>\n      <td>761224</td>\n      <td>200128348</td>\n      <td>201810.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>MARIA DE LOS ANGELES MARTINEZ GONZALEZ</td>\n      <td>761232</td>\n      <td>200128351</td>\n      <td>201810.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>LUIS FERNANDO MARTINEZ GONZALEZ</td>\n      <td>771779</td>\n      <td>200128350</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>FELIPE JOSE CORTISSOZ CARBONELL</td>\n      <td>8797937</td>\n      <td>8797937</td>\n      <td>202230.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>ANDREA CAROLINA ZABALA PINZON</td>\n      <td>96011609578</td>\n      <td>200153987</td>\n      <td>202010.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>CHIARA DARI</td>\n      <td>YB6333348</td>\n      <td>200154255</td>\n      <td>202310.0</td>\n      <td>INTERCAMBIO</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=34}\n``` {.python .cell-code}\n# Crear un mapeo de No_documento a ID desde df3\nid_mapping = faltantes.set_index('Documento')['ID']\n\n# Actualizar los valores NaN en 'ID' de merged_df usando el mapeo de df3\nmerged.loc[na_mask, 'ID'] = merged.loc[na_mask, 'Documento'].map(id_mapping)\n\n```\n:::\n\n\n::: {.cell execution_count=35}\n``` {.python .cell-code}\nmerged[merged['ID'].isnull()] \n```\n\n::: {.cell-output .cell-output-display execution_count=35}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Documento</th>\n      <th>COMPETENCIAS CIUDADANAS</th>\n      <th>COMUNICACIÓN ESCRITA</th>\n      <th>INGLÉS</th>\n      <th>LECTURA CRÍTICA</th>\n      <th>RAZONAMIENTO CUANTITATIVO</th>\n      <th>Periodo</th>\n      <th>Aplicacion</th>\n      <th>Examen</th>\n      <th>Tipo_Documento</th>\n      <th>...</th>\n      <th>Nivel_Desempeño</th>\n      <th>Perc_Mod</th>\n      <th>Perc_nbc_mod</th>\n      <th>ID</th>\n      <th>PUNTAJE_GLOBAL</th>\n      <th>Creditos_Totales_Cursados_PR</th>\n      <th>CRED_APROBADOS_TOTALES</th>\n      <th>Promedio_PR</th>\n      <th>Puntos_Totales_PR</th>\n      <th>Periodo_Matricula</th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n<p>0 rows × 31 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=36}\n``` {.python .cell-code}\nmerged.shape\n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n```\n(4690, 31)\n```\n:::\n:::\n\n\n::: {.cell execution_count=37}\n``` {.python .cell-code}\nrename_col(merged,'PUNTAJE_GLOBAL','SABER11')\n```\n\n::: {.cell-output .cell-output-display}\n<p style='font-size:18px;'>Ejecutamos una función personalizada para cambiar el nombre de la columna <code>PUNTAJE_GLOBAL</code> por <code>SABER11</code> para evitar posibles errores en los procesos posteriores.</p>\n:::\n:::\n\n\n::: {.cell execution_count=38}\n``` {.python .cell-code}\nnotas=pd.read_csv('notas.csv',sep=';',low_memory=False)\nnotas\n```\n\n::: {.cell-output .cell-output-display execution_count=38}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Periodo</th>\n      <th>Codigo_banner</th>\n      <th>Pidm</th>\n      <th>promedio_acumulado</th>\n      <th>Estado_academico</th>\n      <th>Codigo_Programa</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>201410</td>\n      <td>200060024</td>\n      <td>193328</td>\n      <td>3,93</td>\n      <td>NN</td>\n      <td>PINGINDUSTRL</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>201410</td>\n      <td>200060151</td>\n      <td>193527</td>\n      <td>3,33</td>\n      <td>NN</td>\n      <td>PINGINDUSTRL</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>201410</td>\n      <td>200060331</td>\n      <td>193860</td>\n      <td>3,81</td>\n      <td>NN</td>\n      <td>PINGINDUSTRL</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>201410</td>\n      <td>200060007</td>\n      <td>193309</td>\n      <td>3,72</td>\n      <td>NN</td>\n      <td>PINGINDUSTRL</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>201410</td>\n      <td>200060209</td>\n      <td>193650</td>\n      <td>3,9</td>\n      <td>NN</td>\n      <td>PINGINDUSTRL</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>268675</th>\n      <td>202430</td>\n      <td>200152021</td>\n      <td>324378</td>\n      <td>4,19</td>\n      <td>-99</td>\n      <td>PINGINDUSTRL</td>\n    </tr>\n    <tr>\n      <th>268676</th>\n      <td>202430</td>\n      <td>200152188</td>\n      <td>324547</td>\n      <td>4,32</td>\n      <td>-99</td>\n      <td>PINGENICIVIL</td>\n    </tr>\n    <tr>\n      <th>268677</th>\n      <td>202430</td>\n      <td>200150109</td>\n      <td>322383</td>\n      <td>4,07</td>\n      <td>-99</td>\n      <td>PINGINDUSTRL</td>\n    </tr>\n    <tr>\n      <th>268678</th>\n      <td>202430</td>\n      <td>200148566</td>\n      <td>320499</td>\n      <td>4,32</td>\n      <td>-99</td>\n      <td>PINGINDUSTRL</td>\n    </tr>\n    <tr>\n      <th>268679</th>\n      <td>202430</td>\n      <td>200149830</td>\n      <td>322057</td>\n      <td>4,05</td>\n      <td>-99</td>\n      <td>PINGMECANICA</td>\n    </tr>\n  </tbody>\n</table>\n<p>268680 rows × 6 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=39}\n``` {.python .cell-code}\n'''notas= notas.pivot(index='Codigo_banner', columns='Periodo', values='promedio_acumulado')\nnotas'''\n```\n\n::: {.cell-output .cell-output-display execution_count=39}\n```\n\"notas= notas.pivot(index='Codigo_banner', columns='Periodo', values='promedio_acumulado')\\nnotas\"\n```\n:::\n:::\n\n\n::: {.cell execution_count=40}\n``` {.python .cell-code}\nmerged[merged['Periodo']=='2021']\n```\n\n::: {.cell-output .cell-output-display execution_count=40}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Documento</th>\n      <th>COMPETENCIAS CIUDADANAS</th>\n      <th>COMUNICACIÓN ESCRITA</th>\n      <th>INGLÉS</th>\n      <th>LECTURA CRÍTICA</th>\n      <th>RAZONAMIENTO CUANTITATIVO</th>\n      <th>Periodo</th>\n      <th>Aplicacion</th>\n      <th>Examen</th>\n      <th>Tipo_Documento</th>\n      <th>...</th>\n      <th>Nivel_Desempeño</th>\n      <th>Perc_Mod</th>\n      <th>Perc_nbc_mod</th>\n      <th>ID</th>\n      <th>SABER11</th>\n      <th>Creditos_Totales_Cursados_PR</th>\n      <th>CRED_APROBADOS_TOTALES</th>\n      <th>Promedio_PR</th>\n      <th>Puntos_Totales_PR</th>\n      <th>Periodo_Matricula</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2</th>\n      <td>1000148517</td>\n      <td>185.0</td>\n      <td>155.0</td>\n      <td>211.0</td>\n      <td>176.0</td>\n      <td>126.0</td>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>...</td>\n      <td>3</td>\n      <td>89</td>\n      <td>88</td>\n      <td>200129894.0</td>\n      <td>346.0</td>\n      <td>115.0</td>\n      <td>115.0</td>\n      <td>4.02</td>\n      <td>463.4</td>\n      <td>202210.0</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>1000256763</td>\n      <td>180.0</td>\n      <td>166.0</td>\n      <td>184.0</td>\n      <td>167.0</td>\n      <td>131.0</td>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>...</td>\n      <td>3</td>\n      <td>86</td>\n      <td>43</td>\n      <td>200122918.0</td>\n      <td>357.0</td>\n      <td>130.0</td>\n      <td>130.0</td>\n      <td>4.41</td>\n      <td>574.3</td>\n      <td>202130.0</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>1000578348</td>\n      <td>193.0</td>\n      <td>187.0</td>\n      <td>206.0</td>\n      <td>180.0</td>\n      <td>194.0</td>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>...</td>\n      <td>3</td>\n      <td>93</td>\n      <td>79</td>\n      <td>200108084.0</td>\n      <td>384.0</td>\n      <td>231.0</td>\n      <td>231.0</td>\n      <td>4.24</td>\n      <td>981.3</td>\n      <td>202230.0</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>1000653781</td>\n      <td>205.0</td>\n      <td>132.0</td>\n      <td>175.0</td>\n      <td>177.0</td>\n      <td>152.0</td>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>...</td>\n      <td>4</td>\n      <td>98</td>\n      <td>100</td>\n      <td>200109802.0</td>\n      <td>347.0</td>\n      <td>136.0</td>\n      <td>125.0</td>\n      <td>3.63</td>\n      <td>494.6</td>\n      <td>202230.0</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>1000712835</td>\n      <td>185.0</td>\n      <td>168.0</td>\n      <td>200.0</td>\n      <td>170.0</td>\n      <td>150.0</td>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CC</td>\n      <td>...</td>\n      <td>3</td>\n      <td>89</td>\n      <td>90</td>\n      <td>200103174.0</td>\n      <td>331.0</td>\n      <td>146.0</td>\n      <td>146.0</td>\n      <td>3.88</td>\n      <td>566.6</td>\n      <td>202130.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>4684</th>\n      <td>761232</td>\n      <td>177.0</td>\n      <td>161.0</td>\n      <td>196.0</td>\n      <td>149.0</td>\n      <td>110.0</td>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CE</td>\n      <td>...</td>\n      <td>3</td>\n      <td>83</td>\n      <td>58</td>\n      <td>200128351.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4685</th>\n      <td>771779</td>\n      <td>177.0</td>\n      <td>153.0</td>\n      <td>202.0</td>\n      <td>186.0</td>\n      <td>178.0</td>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>CE</td>\n      <td>...</td>\n      <td>3</td>\n      <td>83</td>\n      <td>58</td>\n      <td>200128350.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4686</th>\n      <td>803420</td>\n      <td>90.0</td>\n      <td>160.0</td>\n      <td>152.0</td>\n      <td>124.0</td>\n      <td>123.0</td>\n      <td>2021</td>\n      <td>SABER PRO Y TYT EXTERIOR - 20213</td>\n      <td>Saber Pro</td>\n      <td>CE</td>\n      <td>...</td>\n      <td>1</td>\n      <td>7</td>\n      <td>7</td>\n      <td>200138325.0</td>\n      <td>NaN</td>\n      <td>105.0</td>\n      <td>105.0</td>\n      <td>4.27</td>\n      <td>449.1</td>\n      <td>202210.0</td>\n    </tr>\n    <tr>\n      <th>4688</th>\n      <td>96011609578</td>\n      <td>133.0</td>\n      <td>173.0</td>\n      <td>221.0</td>\n      <td>151.0</td>\n      <td>190.0</td>\n      <td>2021</td>\n      <td>PRO Y TYT 20212</td>\n      <td>Saber Pro</td>\n      <td>TI</td>\n      <td>...</td>\n      <td>2</td>\n      <td>38</td>\n      <td>32</td>\n      <td>200153987.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4689</th>\n      <td>YB6333348</td>\n      <td>135.0</td>\n      <td>124.0</td>\n      <td>208.0</td>\n      <td>164.0</td>\n      <td>127.0</td>\n      <td>2021</td>\n      <td>SABER PRO Y TYT EXTERIOR - 20213</td>\n      <td>Saber Pro</td>\n      <td>PE</td>\n      <td>...</td>\n      <td>2</td>\n      <td>40</td>\n      <td>9</td>\n      <td>200154255.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>2530 rows × 31 columns</p>\n</div>\n```\n:::\n:::\n\n\nNext Step.\n\nAhora sí, EDA, GRaficos, ETC. Buscar los promedios de esta población y asistencia a CAE y CREE, alguna vez estuvo en periodo de prueba? ETC?\n\n1. Visualizacion de Datos Nulos\n\n::: {.cell execution_count=41}\n``` {.python .cell-code}\nplt.figure(figsize=(12, 8))  # Ajustar el tamaño del gráfico\nsns.heatmap(merged.isnull(), cbar=False, cmap='viridis', yticklabels=False)\n\n# Mostrar el gráfico\nplt.title('Mapa de Calor de Valores Nulos en el DataFrame')\nplt.show()\n\n```\n\n::: {.cell-output .cell-output-display}\n![](5_2_cleaning_files/figure-html/cell-42-output-1.png){width=912 height=850}\n:::\n:::\n\n\n::: {.cell execution_count=42}\n``` {.python .cell-code}\nmerged.columns\n```\n\n::: {.cell-output .cell-output-display execution_count=42}\n```\nIndex(['Documento', 'COMPETENCIAS CIUDADANAS', 'COMUNICACIÓN ESCRITA',\n       'INGLÉS', 'LECTURA CRÍTICA', 'RAZONAMIENTO CUANTITATIVO', 'Periodo',\n       'Aplicacion', 'Examen', 'Tipo_Documento', 'Nombre', 'Numero_Registro',\n       'Tipo_Evaluado', 'SNIES_Programa', 'Programa', 'Ciudad', 'ID_NBC',\n       'NBC', 'PG', 'Perc_Global', 'Perc_NBC', 'Nivel_Desempeño', 'Perc_Mod',\n       'Perc_nbc_mod', 'ID', 'SABER11', 'Creditos_Totales_Cursados_PR',\n       'CRED_APROBADOS_TOTALES', 'Promedio_PR', 'Puntos_Totales_PR',\n       'Periodo_Matricula'],\n      dtype='object')\n```\n:::\n:::\n\n\n::: {.cell execution_count=43}\n``` {.python .cell-code}\nNulls_Uniques(merged,'SABER11')\n```\n\n::: {.cell-output .cell-output-display}\n<p style='font-size:18px;'>Este campo tiene 75 registros nulos  y  240 valores únicos </p>\n:::\n\n::: {.cell-output .cell-output-display}\n<p style='font-size:18px;'>Sus valores únicos son:</p>\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>count</th>\n    </tr>\n    <tr>\n      <th>SABER11</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>350.0</th>\n      <td>93</td>\n    </tr>\n    <tr>\n      <th>353.0</th>\n      <td>88</td>\n    </tr>\n    <tr>\n      <th>348.0</th>\n      <td>83</td>\n    </tr>\n    <tr>\n      <th>358.0</th>\n      <td>81</td>\n    </tr>\n    <tr>\n      <th>352.0</th>\n      <td>81</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>57.0</th>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>59.0</th>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>210.0</th>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>227.0</th>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>422.0</th>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n<p>240 rows × 1 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=44}\n``` {.python .cell-code}\nmerge_final=merged[~merged['SABER11'].isnull()]\nmerge_final.reset_index(inplace=True, drop=True)\n```\n:::\n\n\n::: {.cell execution_count=45}\n``` {.python .cell-code}\ndf=merge_final.copy()\n\n```\n:::\n\n\n::: {.cell execution_count=46}\n``` {.python .cell-code}\ndf.to_csv('dataforeda.csv', index=False)\n```\n:::\n\n\n## AHORA SI, PROBEMOS LOS PRIMEROS MODELOS Y EDA\n\n\n",
    "supporting": [
      "5_2_cleaning_files\\figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}